<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Christoph's Blog about Digital Stuff]]></title><description><![CDATA[A blog about digital stuff.]]></description><link>https://cgrotz.github.io</link><generator>GatsbyJS</generator><lastBuildDate>Sat, 06 Feb 2021 16:23:23 GMT</lastBuildDate><item><title><![CDATA[Processing the Firmware Installation]]></title><description><![CDATA[This is the sixth part of a multi-part blog post. You might want to start from the beginning with the first post. In the previous part I…]]></description><link>https://cgrotz.github.io/2020-09-01-esp32_ci_cd_part6/</link><guid isPermaLink="false">https://cgrotz.github.io/2020-09-01-esp32_ci_cd_part6/</guid><pubDate>Tue, 01 Sep 2020 20:13:00 GMT</pubDate><content:encoded>&lt;p&gt;This is the sixth part of a multi-part blog post. You might want to start from the beginning with the &lt;a href=&quot;/2020-08-23-esp32_ci_cd_part1&quot;&gt;first post&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In the &lt;a href=&quot;/2020-08-31-esp32_ci_cd_part5&quot;&gt;previous part&lt;/a&gt; I showed you how to establish connection with the Bosch IoT Suite. In this part I will be showing you the necessary steps to receive firmware update commands from the IoT Suite and flash the firmware onto the device. Let’s start by adding a few headers that we are going to need for this project.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;Update.h&gt;&lt;/span&gt;       &lt;span class=&quot;token comment&quot;&gt;// The OTA client of the ESP32&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;HTTPClient.h&gt;&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;// The HTTP Client for downloading the firmware&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;Stream.h&gt;&lt;/span&gt;       &lt;span class=&quot;token comment&quot;&gt;// We need this for streaming the file to the flash&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;StreamString.h&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When a distribution set is assigned to a target in IoT Rollouts, IoT Manager will translate this into an install command on the device shadow in case that the device shadow has a &lt;a href=&quot;https://vorto.eclipse.org/#/details/org.eclipse.hawkbit.swupdatable:SoftwareUpdatable:2.0.0&quot;&gt;SoftwareUpdatable&lt;/a&gt; function block. (Version 1 of the Vorto Functionblock will only be supported during the public Beta of the Device Management Package) So step 1 is registering the SoftwareUpdateable function block. Let’s extend the connect function to update the device shadow.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;//...&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Update device shadow with SoftwareUpdateable function block&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;char&lt;/span&gt; payload&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;sprintf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;payload&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;{\r\n\t\&quot;topic\&quot;: \&quot;%s/%s/things/twin/commands/modify\&quot;,\r\n\t\&quot;path\&quot;: \&quot;/features/softwareupdatable\&quot;,\r\n\t\&quot;value\&quot;: {\r\n\t \t\&quot;definition\&quot;: [\r\n\t \t\t\&quot;org.eclipse.hawkbit.swupdatable:SoftwareUpdatable:1.0.0\&quot;\r\n\t \t],\r\n \t \t\&quot;properties\&quot;: {\r\n \t\t \t\&quot;status\&quot;: {\r\n \t\t\t \t\&quot;agentName\&quot; : \&quot;m5stack\&quot;,\r\n \t\t\t \t\&quot;agentVersion\&quot; : \&quot;1.0.0\&quot;,\r\n \t\t\t \t\&quot;type\&quot; : \&quot;application\&quot;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; hubNamespace&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; deviceId &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;publish&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;event&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; payload&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    M5&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Lcd&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Failed publishing &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    M5&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Lcd&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;lastError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Something to point out is the type property that identifie what type of software module the device shadow accepts. In this case type has the value &lt;em&gt;application&lt;/em&gt;, this needs to correlate with the type on the SoftwareModule we are creating in IoT Rollouts.&lt;/p&gt;
&lt;p&gt;The message send from the Suite to the device will then look similar to this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token property&quot;&gt;&quot;topic&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;namespace/thing_id/things/live/messages/install&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;token property&quot;&gt;&quot;headers&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;token property&quot;&gt;&quot;content-type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;application/json&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
		&lt;span class=&quot;token property&quot;&gt;&quot;version&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
		&lt;span class=&quot;token property&quot;&gt;&quot;correlation-id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;p-pdid85-1fzfisu1ae6v5f-3vj06&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
		&lt;span class=&quot;token property&quot;&gt;&quot;x-things-parameter-order&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;[\&quot;arg_0\&quot;]&quot;&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;token property&quot;&gt;&quot;path&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/features/softwareupdatable/inbox/messages/install&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;token property&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;token property&quot;&gt;&quot;arg_0&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;token property&quot;&gt;&quot;softwareModules&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;token property&quot;&gt;&quot;metaData&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
				&lt;span class=&quot;token property&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
				&lt;span class=&quot;token property&quot;&gt;&quot;version&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1.0.0&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
				&lt;span class=&quot;token property&quot;&gt;&quot;artifacts&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;token property&quot;&gt;&quot;filename&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;generated_eclipseditto_1.0.0-SNAPSHOT_SoftwareUpdatable_thingJson.json&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
					&lt;span class=&quot;token property&quot;&gt;&quot;size&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;764&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
					&lt;span class=&quot;token property&quot;&gt;&quot;hashes&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
						&lt;span class=&quot;token property&quot;&gt;&quot;sha1&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;d12f37d9774e1cf2f9bfcc21a2f1091617775a58&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
						&lt;span class=&quot;token property&quot;&gt;&quot;sha256&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;e3399ace3f2cc70f337f3be894852d307e5a10abec163ac7dc53148984b70537&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
						&lt;span class=&quot;token property&quot;&gt;&quot;md5&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;d173d3d61191d5d8f4b630889905b054&quot;&lt;/span&gt;
					&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
					&lt;span class=&quot;token property&quot;&gt;&quot;links&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
						&lt;span class=&quot;token property&quot;&gt;&quot;download&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
							&lt;span class=&quot;token property&quot;&gt;&quot;http&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
							&lt;span class=&quot;token property&quot;&gt;&quot;https&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;https://link to artifact&quot;&lt;/span&gt;
						&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
						&lt;span class=&quot;token property&quot;&gt;&quot;md5sum&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
					&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
				&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
			&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;token property&quot;&gt;&quot;dsMetaData&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;token property&quot;&gt;&quot;weight&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;token property&quot;&gt;&quot;correlationId&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;32845&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;token property&quot;&gt;&quot;actionProperties&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;token property&quot;&gt;&quot;actionType&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;FORCED&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
				&lt;span class=&quot;token property&quot;&gt;&quot;forceTime&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
			&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The key elements that we will need to process are the path property, the correlationId of the software installation request &lt;em&gt;value.arg_0.correlationId&lt;/em&gt; and the url to the artifact &lt;em&gt;value.arg_0.softwareModules.[].artifacts.[].links.download.https&lt;/em&gt;. Let’s add the handling code with some global variables for processing the message. (The arg_0 will be replaced after the public beta with the correct property name).&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// New global variables&lt;/span&gt;
String INSTALLATION_PATH &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/features/softwareupdatable/inbox/messages/install&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; installationState &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
StaticJsonDocument&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; installationCommand&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;messageReceived&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;String &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;mqttTopic&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;INSTALLATION_PATH&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;path&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    installationState &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    installationCommand &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; doc&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In case that we receive a installation command, we store the whole message and set the state to 1, to indicate that in the next run of the loop function we want to process the firmware update. We do this since we will need to communicate with the IoT Suite and we shouldn’t do this from the messageReceived callback.&lt;/p&gt;
&lt;p&gt;Next I am going to extend the loop function for processing the software update state. It will extract the remaining information from the cached message, and trigger a download and installation function.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;installationState &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; correlationId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; installationCommand&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;arg_0&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;correlationId&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    JsonArray softwareModules &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; installationCommand&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;arg_0&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;softwareModules&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;as&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;JsonArray&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;JsonVariant v &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; softwareModules&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      JsonObject moduleDoc &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; v&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;as&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;JsonObject&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      String module &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; moduleDoc&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      String version &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; moduleDoc&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;version&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      
      client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;publish&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;event&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;buildInstallationState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;correlationId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; module&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; version&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;STARTED&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  
      JsonArray artifacts &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; moduleDoc&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;artifacts&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;as&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;JsonArray&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;JsonVariant artifactVariant &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; artifacts&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        JsonObject artifact &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; artifactVariant&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;as&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;JsonObject&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        String filename &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; artifact&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;filename&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        String md5 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; artifact&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;hashes&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;md5&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        String url &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; artifact&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;links&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;download&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;https&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;downloadAndInstallFirmware&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;correlationId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; module&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; version&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    installationState &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;em&gt;downloadAndInstallFirmware&lt;/em&gt; function will open a HTTPS connection to start downloading the artifact as a stream and pass it to the update handler of the ESP32. It will also create MQTT messages in order to update the device shadow. The IoT Suite transforms this shadow updates into state tranistions on the Distribution Set assignment in IoT Rollouts. You can find the code for the &lt;em&gt;buildInstallationState&lt;/em&gt; helper functions down below.&lt;/p&gt;
&lt;p&gt;The update itself is handled by four functions, that are part of the ESP32’s Update functionality. &lt;em&gt;Update.begin(int update_size)&lt;/em&gt; needs to be called when you want to start an update, it responds true if the device is ready to be updated and the update size doesn’t exceed the parition size. &lt;em&gt;Update.writeStream(stream)&lt;/em&gt; takes a binary stream that should be written to the flash storage. With &lt;em&gt;Update.end()&lt;/em&gt; you can inform the ESP32 that the whole stream was transfered, with &lt;em&gt;Update.isFinished()&lt;/em&gt; you can check if the ESP32 succesfully checked and accepted the update.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;downloadAndInstallFirmware&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;String correlationId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String module&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
    String version&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  WiFiClientSecure net2&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;[HTTPS] Downloading Firmware %s\n&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; url&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;c_str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  HTTPClient https&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;https&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;begin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;net2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; url&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;c_str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; httpCode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; https&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;GET&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// httpCode will be negative on error&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;httpCode &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;// HTTP header has been send and Server response header has been handled&lt;/span&gt;
      Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;[HTTPS] GET... code: %d\n&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; httpCode&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

      &lt;span class=&quot;token comment&quot;&gt;// file found at server&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;httpCode &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; HTTP_CODE_OK &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; httpCode &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; HTTP_CODE_MOVED_PERMANENTLY&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;publish&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;event&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;buildInstallationState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;correlationId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; module&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; version&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;INSTALLING&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;bool&lt;/span&gt; canBegin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Update&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;begin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;https&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getSize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;canBegin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
          Update&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;writeStream&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;https&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getStream&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

          &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;connected&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Update&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;OTA done!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;publish&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;event&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;buildInstallationState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;correlationId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; module&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; version&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;INSTALLED&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Update&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;isFinished&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
              client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;publish&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;event&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;buildInstallationState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;correlationId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; module&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; version&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;FINISHED_SUCCESS&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
              restart &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
              client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;publish&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;event&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;buildInstallationState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;correlationId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; module&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; version&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;FINISHED_ERROR&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
              Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Update not finished? Something went wrong!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
              client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;publish&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;event&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;buildInstallationState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;correlationId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; module&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; version&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;FINISHED_ERROR&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Error Occurred. Error #: &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Update&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Error Occurred. Error #: &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Update&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;[HTTPS] GET... failed, error: %s\n&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; https&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;errorToString&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;httpCode&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;c_str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    https&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Failed downloading&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In the following snippet you will find the &lt;em&gt;buildInstallationState&lt;/em&gt; helper functions.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;String &lt;span class=&quot;token function&quot;&gt;buildInstallationState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;String correlationId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String moduleName&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
    String version&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String state&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;char&lt;/span&gt; payload&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;{\r\n\t\&quot;topic\&quot;: \&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;hubNamespace&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;deviceId&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/things/twin/commands/modify\&quot;,\r\n\t\&quot;path\&quot;: \&quot;/features/&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;moduleName&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\&quot;,\r\n\t\&quot;value\&quot;: {\r\n\t \t\&quot;definition\&quot;: [\r\n\t \t\t\&quot;org.eclipse.hawkbit.swmodule:SoftwareModule:1.0.0\&quot;\r\n\t \t],\r\n \t \t\&quot;properties\&quot;: {\r\n \t\t \t\&quot;status\&quot;: {\r\n \t\t\t \t\&quot;moduleName\&quot; : \&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;moduleName&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\&quot;,\r\n \t\t\t \t\&quot;moduleVersion\&quot; : \&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;version&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\&quot;,\r\n \t\t\t \t\&quot;status\&quot; : {\r\n\t\t\t\t\t\&quot;correlationId\&quot;: \&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;correlationId&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\&quot;,\r\n\t\t\t\t\t\&quot;operation\&quot;: \&quot;install\&quot;,\r\n\t\t\t\t\t\&quot;status\&quot;: \&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;state&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\&quot;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

String &lt;span class=&quot;token function&quot;&gt;buildInstallationState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;String correlationId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String moduleName&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
    String version&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String state&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String message&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;{\r\n\t\&quot;topic\&quot;: \&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;hubNamespace&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;deviceId&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/things/twin/commands/modify\&quot;,\r\n\t\&quot;path\&quot;: \&quot;/features/&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;moduleName&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\&quot;,\r\n\t\&quot;value\&quot;: {\r\n\t \t\&quot;definition\&quot;: [\r\n\t \t\t\&quot;org.eclipse.hawkbit.swmodule:SoftwareModule:1.0.0\&quot;\r\n\t \t],\r\n \t \t\&quot;properties\&quot;: {\r\n \t\t \t\&quot;status\&quot;: {\r\n \t\t\t \t\&quot;moduleName\&quot; : \&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;moduleName&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\&quot;,\r\n \t\t\t \t\&quot;moduleVersion\&quot; : \&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;version&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\&quot;,\r\n \t\t\t \t\&quot;status\&quot; : {\r\n\t\t\t\t\t\&quot;correlationId\&quot;: \&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;correlationId&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\&quot;,\r\n\t\t\t\t\t\&quot;operation\&quot;: \&quot;install\&quot;,\r\n\t\t\t\t\t\&quot;status\&quot;: \&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;state&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\&quot;,\r\n\t\t\t\t\t\&quot;message\&quot;: \&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;message&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\&quot;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As always, you can find the complete &lt;a href=&quot;https://github.com/cgrotz/esp32-cd-firmware-example&quot;&gt;sources&lt;/a&gt; on GitHub.&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Voilà, we are at the end. Pushed to the master branch in Github will now create a new firmware image, that is automatically pushed to the Bosch IoT Suite, which in turn automatically assigns it to the device, the device will then self update.&lt;/p&gt;
&lt;p&gt;There is a lot of room for improvement for this simple example. Let’s make a short list of a few points I would consider. I bet there are many more that you might come up with.&lt;/p&gt;
&lt;h3&gt;device Configuration not externalized&lt;/h3&gt;
&lt;p&gt;In the above code, the Wifi configuration as well as the device credentials are hard coded into the code. This should be externalized to the flash or a SD storage. This way the firmware image is not device specific anymore.&lt;/p&gt;
&lt;h3&gt;Resilience for firmware flashing&lt;/h3&gt;
&lt;p&gt;At the moment the firmware image is downloaded and directly streamed to the ESP32’s unused firmware partition. Since the ESP32 uses a two partition concept for firmware update and checks the partition, we already have some resilience (&lt;a href=&quot;https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/system/ota.html&quot;&gt;OTA Process Documentation&lt;/a&gt;. It would still be good to download the file and verify the downloaded image against the checksum.&lt;/p&gt;
&lt;p&gt;Also having a potential rollback after updating in case that the device is not able to for example connect would be nice. But this obviously also necessitates to externalize the update state to the flash or SD storage.&lt;/p&gt;
&lt;h3&gt;Code Cleanup&lt;/h3&gt;
&lt;p&gt;I tried to keep the whole code in a single file, to make it easier to understand for a person reading the blog. In a real production setting it would of course be better to separate the different concers into separate components.&lt;/p&gt;
&lt;p&gt;Of course other things like the BAUD Rate would be more suitable in a #define statement.&lt;/p&gt;
&lt;h3&gt;State Handling&lt;/h3&gt;
&lt;p&gt;The way that the install state is handled is definitely not a good way to do it in production. There are multiple states that aren’t handled properly. In a real production scenario you should use a proper state machine to hande this, or maybe use RTOS task scheduling to handle the state transitions.&lt;/p&gt;
&lt;p&gt;Thanks for reading this long blog post. I hope you were able to take away some information or ideas.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Connecting the ESP32 to the Bosch IoT Suite]]></title><description><![CDATA[This is the fifth part of a multi-part blog post. You might want to start from the beginning with the first post. In this part we beginn…]]></description><link>https://cgrotz.github.io/2020-08-31-esp32_ci_cd_part5/</link><guid isPermaLink="false">https://cgrotz.github.io/2020-08-31-esp32_ci_cd_part5/</guid><pubDate>Mon, 31 Aug 2020 20:13:00 GMT</pubDate><content:encoded>&lt;p&gt;This is the fifth part of a multi-part blog post. You might want to start from the beginning with the &lt;a href=&quot;/2020-08-23-esp32_ci_cd_part1&quot;&gt;first post&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In this part we beginn with connecting our device with the Bosch IoT Suite. In order to do this, we need to establish a MQTT connection to the IoT Hub. We will also update the devices device shadow in IoT Things to verify the connection.&lt;/p&gt;
&lt;p&gt;In the &lt;a href=&quot;/2020-08-26-esp32_ci_cd_part4&quot;&gt;last part&lt;/a&gt;, we made the necessary configuration in the IoT Suite and provisioned our device, we will need the credentials in this part. You can find the full code example at the bottom of the page.&lt;/p&gt;
&lt;p&gt;Let’s start with a basic project setup, in the following platformio.ini you can see the libraries necessary for our approach&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ini&quot;&gt;&lt;pre class=&quot;language-ini&quot;&gt;&lt;code class=&quot;language-ini&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;[env:m5stack-core-esp32]&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;platform&lt;/span&gt; &lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; espressif32&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;framework&lt;/span&gt; &lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; arduino&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;board&lt;/span&gt; &lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; m5stack-core-esp32&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;lib_deps&lt;/span&gt; &lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;/span&gt;
	MQTT@^2.4.7         ; The MQTT Client
	ArduinoJson@^6.16.1 ; A library for decoding the JSON messages from Bosch IoT Things&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;platformio.ini for our project&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;At the moment our main.cpp is probably rather empty and should look like the following example.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;Arduino.h&gt;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// put your setup code here, to run once:&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// put your main code here, to run repeatedly:&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;The starting point main.cpp&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;So let’s start with adding some headers for the libraries that we need.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;Arduino.h&gt;&lt;/span&gt; &lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;ArduinoJson.h&gt;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// JSON Serialization and Deserialization&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;MQTT.h&gt;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// MQTT communication&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;WiFiClientSecure.h&gt;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// Wifi Client with TLS support &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;What sticks out is, the &lt;em&gt;WiFiClientSecure.h&lt;/em&gt; since the Bosch IoT Hub uses TLS encrypted communication we cannot just use the default WifiClient for establishing the TCP connections for accessing the MQTT connector of the IoT Hub.&lt;/p&gt;
&lt;p&gt;Next we need to make the Wifi connection. You will need to replace the place holders with your actual wifi configuration&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\nchecking wifi...&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;WiFi&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; WL_CONNECTED&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot; connected to wifi!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;begin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;115200&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  WiFi&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;begin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;your wifi SSID&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;your wifi password&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;No that we have our Wifi connection we need to establish the MQTT connection. Let’s add a &lt;em&gt;WifiClientSecure&lt;/em&gt; and a &lt;em&gt;MQTTClient&lt;/em&gt; to our global variables.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;WiFiClientSecure net&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// We need to increase message size since the IoT Suite messages can be rather big&lt;/span&gt;
MQTTClient &lt;span class=&quot;token function&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2048&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Next steps is initalize the clients. We do this in the &lt;em&gt;connect&lt;/em&gt; function we previously created.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\nconnecting to mqtt...&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;begin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;mqtt.bosch-iot-hub.com&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8883&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; net&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;namespace:deviceId&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;namespace_deviceId@tenantId&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; mqttPassword&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
  client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// we need to call client loop in order for the mqtt client to process messages&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;// we add a few millisecond delay for wifi stability&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;connected&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// in case that the mqtt client is not connected anymore, we want to trigger a reconnect&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This should successfully connect the MQTT client, but how do can you tell? In the Bosch IoT Things dashboard your device should look very empty at the moment. (If you already connected it, you might see a connection status feature).&lt;/p&gt;
&lt;p&gt;Let’s send a periodic message to IoT Things from the loop method, that updates the device shadow of the device. You will need to replace &lt;em&gt;&lt;namespace&gt;&lt;/em&gt; and &lt;em&gt;&lt;deviceId&gt;&lt;/em&gt; with the values from your device registration.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;long&lt;/span&gt; lastMillis &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// publish a message roughly every second.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; lastMillis &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    lastMillis &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;publish&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;event&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;{\r\n\t\&quot;topic\&quot;: \&quot;&amp;lt;namespace&gt;/&amp;lt;deviceId&gt;/things/twin/commands/modify\&quot;,\r\n\t\&quot;path\&quot;: \&quot;/features/version\&quot;,\r\n\t\&quot;value\&quot;: {\r\n\t \t\&quot;properties\&quot;: {\r\n \t\t \t\&quot;version\&quot;: \&quot;1.0.8\&quot;\r\n\t\t}\r\n\t}\r\n}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Failed publishing &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;lastError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The device shadow in the Things dashboard should now be updated, and should contain a new feature called version that has a property version with the value 1.0.0.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/60843df04ec0fe77fe12ab32c1deaa19/80521/device_with_version.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 27.7027027027027%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAApElEQVQY04WQjQ6DMAiEff9HrbOx6U9SBG7SqtPMOZILDaHfAYNzDrVWWKjql2A6xV2Pbj3EgmEcR3jvkXPZfuDInadgZsQYQUSPUDagNc7BIySPRSoql9WptLeqNKiIIKWEEAIW7vWr+8dkKKUg5QhWapBdLHSssmebVIQv9fPKDWju02ta3WckmpDJsocobzNcPz1FA7Zjrrep1Kfa9etO//QGREfZycGUCicAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;device with version&quot;
        title=&quot;device with version&quot;
        src=&quot;/static/60843df04ec0fe77fe12ab32c1deaa19/fcda8/device_with_version.png&quot;
        srcset=&quot;/static/60843df04ec0fe77fe12ab32c1deaa19/12f09/device_with_version.png 148w,
/static/60843df04ec0fe77fe12ab32c1deaa19/e4a3f/device_with_version.png 295w,
/static/60843df04ec0fe77fe12ab32c1deaa19/fcda8/device_with_version.png 590w,
/static/60843df04ec0fe77fe12ab32c1deaa19/efc66/device_with_version.png 885w,
/static/60843df04ec0fe77fe12ab32c1deaa19/c83ae/device_with_version.png 1180w,
/static/60843df04ec0fe77fe12ab32c1deaa19/80521/device_with_version.png 2416w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;Device shadow with version feature&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Last but not least, we would also like to be able to receive messages from the IoT Suite. We will not use this in this post directly, but I think this post wouldn’t be complete without this step.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// add this method as a callback, for receiving new messages&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;messageReceived&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;String &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;mqttTopic&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  StaticJsonDocument&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; doc&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;deserializeJson&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;doc&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  String topic &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; doc&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;topic&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  String path &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; doc&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;path&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;incoming topic: &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;topic&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot; path: &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;path&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;incoming: &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; mqttTopic &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot; - &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  
  &lt;span class=&quot;token comment&quot;&gt;// Note: Do not use the client in the callback to publish, subscribe or&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// unsubscribe as it may cause deadlocks when other things arrive while&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// sending and receiving acknowledgments. Instead, change a global variable,&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// or push to a queue and handle it in the loop after calling `client.loop()`.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ... add the following line below client.begin(&quot;mqtt.bosch-iot-hub.com&quot;, 8883, net);&lt;/span&gt;
  client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;onMessage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;messageReceived&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ... add the following line below the client connect loop&lt;/span&gt;
  client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;subscribe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;command///req/#&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In the &lt;em&gt;messageReceived&lt;/em&gt; function, I am using ArduinoJson to extract the JSON payload. Let’s have a quick look at the typical message structure Eclipse Ditto is using (on which Bosch IoT Things is build on top). There are four keys that are making the basic message frame topic, headers, path and value. Topic identifies what kind of message we are receiving, while path identifies which part of the Device shadow is the origin of the message. Headers is a key-value map with meta information for message procssing (just like in HTTP requests). Value contains the payload that we are interessted in. You can find more information regarding the protocol in the Eclipse Ditto &lt;a href=&quot;https://www.eclipse.org/ditto/protocol-overview.html&quot;&gt;documentation&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token property&quot;&gt;&quot;topic&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;namespace/thing_id/type_of_message&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
	&lt;span class=&quot;token property&quot;&gt;&quot;headers&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    ...
	&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;token property&quot;&gt;&quot;path&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;path_relating_to_feature&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;token property&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    ...
	&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Congratulations, you are now able to send and receive message to and from the IoT Suite. A possible improvement would of course be to check the IoT Hub’s certificate for authenticity. But I will leave this to you. &lt;/p&gt;
&lt;p&gt;The following is a slightly cleaned up full example of what we just did. We will use this in the next post to continue the integration work. You can find the complete project on &lt;a href=&quot;https://www.github.com/cgrotz/esp32-iot-hub-connection&quot;&gt;Github&lt;/a&gt;. If you want to continue, here is a link that takes you to &lt;a href=&quot;/2020-09-01-esp32_ci_cd_part6&quot;&gt;part 6&lt;/a&gt; right away.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;Arduino.h&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;WiFiClientSecure.h&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;ArduinoJson.h&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;MQTT.h&gt;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;char&lt;/span&gt; ssid&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;Wifi SSID&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;char&lt;/span&gt; pass&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;Wifi Password&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Connetion parameters from the provisioning json file&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;char&lt;/span&gt; hubNamespace&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;the namespace we created&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;char&lt;/span&gt; deviceId&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;deviceId&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;char&lt;/span&gt; tenantId&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;iot hub tenant&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;char&lt;/span&gt; mqttPassword&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;MQTT Password&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Since Bosch IoT Hub needs TLS, we need to use the WifiClient Secure instead of the normal Wifi Client&lt;/span&gt;
WiFiClientSecure net&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// We need to increase message size since the IoT Suite messages can be rather big&lt;/span&gt;
MQTTClient &lt;span class=&quot;token function&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2048&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;long&lt;/span&gt; lastMillis &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;messageReceived&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;String &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;mqttTopic&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  StaticJsonDocument&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; doc&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;deserializeJson&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;doc&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  String topic &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; doc&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;topic&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  String path &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; doc&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;path&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;incoming topic: &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;topic&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot; path: &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;path&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;incoming: &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; mqttTopic &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot; - &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  
  &lt;span class=&quot;token comment&quot;&gt;// Note: Do not use the client in the callback to publish, subscribe or&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// unsubscribe as it may cause deadlocks when other things arrive while&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// sending and receiving acknowledgments. Instead, change a global variable,&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// or push to a queue and handle it in the loop after calling `client.loop()`.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\nchecking wifi...&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;WiFi&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; WL_CONNECTED&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot; connected to wifi!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\nconnecting to mqtt...&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;begin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;mqtt.bosch-iot-hub.com&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8883&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; net&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;onMessage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;messageReceived&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; wait &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;char&lt;/span&gt; mqttDeviceId&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;char&lt;/span&gt; mqttUsername&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;sprintf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mqttDeviceId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;%s:%s&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; hubNamespace&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; deviceId&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;sprintf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mqttUsername&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;%s_%s@%s&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; hubNamespace&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; deviceId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; tenantId&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mqttDeviceId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; mqttUsername&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;mqttPassword&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; wait &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    wait&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;connected&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot; not connected to mqtt!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot; connected to mqtt!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// Subscribe to commands from IoT Suite&lt;/span&gt;
  client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;subscribe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;command///req/#&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;begin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;115200&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  WiFi&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;begin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ssid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pass&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;// we add a few millisecond delay for wifi stability&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;connected&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// publish a message roughly every second.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; lastMillis &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    lastMillis &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;char&lt;/span&gt; payload&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;sprintf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;payload&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;{\r\n\t\&quot;topic\&quot;: \&quot;%s/%s/things/twin/commands/modify\&quot;,\r\n\t\&quot;path\&quot;: \&quot;/features/version\&quot;,\r\n\t\&quot;value\&quot;: {\r\n\t \t\&quot;properties\&quot;: {\r\n \t\t \t\&quot;version\&quot;: \&quot;1.0.8\&quot;\r\n\t\t}\r\n\t}\r\n}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;hubNamespace&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; deviceId &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;publish&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;event&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; payload&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Failed publishing &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      Serial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;lastError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[Uploading the firmware to Bosch IoT Rollouts]]></title><description><![CDATA[This is the fourth part of a multi-part blog post. You might want to start from the beginning with the first post. Welcome back, in this…]]></description><link>https://cgrotz.github.io/2020-08-26-esp32_ci_cd_part4/</link><guid isPermaLink="false">https://cgrotz.github.io/2020-08-26-esp32_ci_cd_part4/</guid><pubDate>Wed, 26 Aug 2020 08:13:00 GMT</pubDate><content:encoded>&lt;p&gt;This is the fourth part of a multi-part blog post. You might want to start from the beginning with the &lt;a href=&quot;/2020-08-23-esp32_ci_cd_part1&quot;&gt;first post&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Welcome back, in this part of the series we are going to connect our firmware build to Bosch IoT Rollouts. We need to add several new build steps to our GitHub Actions yaml (if you followed the example in &lt;a href=&quot;/2020-08-24-esp32_ci_cd_part2&quot;&gt;Part 2&lt;/a&gt; it should be placed under &lt;em&gt;.github/workflows/ci.yml&lt;/em&gt;). You can find the complete example at the end of the post.&lt;/p&gt;
&lt;p&gt;We are going to use the short form of the the GIT commit hash as version identifier for the continuous build.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Extract git commit id
      &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; vars
      &lt;span class=&quot;token key atrule&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; bash
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
        echo &quot;##[set-output name=branch;]$(echo ${GITHUB_REF#refs/heads/})&quot;
        echo &quot;::set-output name=sha_short::$(git rev-parse --short HEAD)&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;Extracting the GIT metadata. Thanks to aborilov for this piece of code from Stack overflow &lt;a href=&quot;https://stackoverflow.com/a/58035262&quot;&gt;link&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;We need to create a Software Module, to which we then can upload the artifact.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; create_sm
      &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Create Software Module
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cgrotz/hawkbit&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;create&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;software&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;module&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;action@v4
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-tenant&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_TENANT &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-username&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_USERNAME &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-password&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_PASSWORD &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;software-module-name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Beta Firmware
        &lt;span class=&quot;token key atrule&quot;&gt;software-module-type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Application
        &lt;span class=&quot;token key atrule&quot;&gt;software-module-version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; steps.vars.outputs.sha_short &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;Creating a software module&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Then we can upload the binary to the software module.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Upload Artifact
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cgrotz/hawkbit&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;upload&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;artifact&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;action@v2
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;file-path&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .pio/build/m5stack&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;core&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;esp32/firmware.bin
        &lt;span class=&quot;token key atrule&quot;&gt;software-module-id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; steps.create_sm.outputs.software&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;module&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;id &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-tenant&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_TENANT &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-username&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_USERNAME &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-password&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_PASSWORD &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;Uploading the firmware binary to the software module. Please be mindful of the path, this might be different if the environment in the platform.ini is named differently.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Now we create a distribution set and assign the software module to it. This can be done in one step using IoT Rollouts.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; create_ds
      &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Create Distribution Set
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cgrotz/hawkbit&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;create&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;distribution&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;set&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;action@v5
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-tenant&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_TENANT &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-username&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_USERNAME &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-password&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_PASSWORD &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;distribution-set-name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Beta Firmware
        &lt;span class=&quot;token key atrule&quot;&gt;distribution-set-type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; app
        &lt;span class=&quot;token key atrule&quot;&gt;distribution-set-version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; steps.vars.outputs.sha_short &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;software-module-ids&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; steps.create_sm.outputs.software&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;module&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;id &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;Creating a new distribution set with the software moduel pre assigned&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Lastly we are assigning the distribution set to the target filter.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Assign distribution set to target filter
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cgrotz/hawkbit&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;assign&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;ds&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;to&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;filter&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;action@v8
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-tenant&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_TENANT &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-username&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_USERNAME &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-password&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_PASSWORD &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;target-filter-name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Beta Filter
        &lt;span class=&quot;token key atrule&quot;&gt;target-filter-type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; forced
        &lt;span class=&quot;token key atrule&quot;&gt;target-filter-weight&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;distribution-set-id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; steps.create_ds.outputs.distribution&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;set&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;id &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;Assigning the distribution set to our target filter&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;You also need to setup the credentials for IoT Rollouts in GitHub. I used the build in screts mechanism of GitHub for this.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/67c29a787042700853c7a0ad6332352c/d2782/github_actions_result.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 40.54054054054054%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAyUlEQVQoz5VS0Q6DIAzk//9rj/uK7QEUFQR0UPBWjDPbwxJscmlpmuu1RfgIuPCCtQbOe/YzZufgQ8C2bc2gnJEZYn4BcrBQSkFKha7robWGsRZXrJSCzBBpDXCjxrqsmIxBSuksalVXiXIueyxu8o7H8ITuNMZpQliWvVsrWbUYE69oQWQxQo09BjOdsq/s7Yf48CIngvEJ0hJGT3uyVJTDf+Lv95Hbx+VDBF4XxYjCXMLzZftes1ziQvwdq3WnonYgoqYv0UL4BivvdgluFrlGAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;github actions result&quot;
        title=&quot;github actions result&quot;
        src=&quot;/static/67c29a787042700853c7a0ad6332352c/fcda8/github_actions_result.png&quot;
        srcset=&quot;/static/67c29a787042700853c7a0ad6332352c/12f09/github_actions_result.png 148w,
/static/67c29a787042700853c7a0ad6332352c/e4a3f/github_actions_result.png 295w,
/static/67c29a787042700853c7a0ad6332352c/fcda8/github_actions_result.png 590w,
/static/67c29a787042700853c7a0ad6332352c/efc66/github_actions_result.png 885w,
/static/67c29a787042700853c7a0ad6332352c/c83ae/github_actions_result.png 1180w,
/static/67c29a787042700853c7a0ad6332352c/d2782/github_actions_result.png 1864w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The setup secrets in GitHub Actions&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;Complete example build pipeline&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;push&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ubuntu&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;latest
    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/checkout@v1
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Extract git commit id
      &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; vars
      &lt;span class=&quot;token key atrule&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; bash
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
        echo &quot;##[set-output name=branch;]$(echo ${GITHUB_REF#refs/heads/})&quot;
        echo &quot;::set-output name=sha_short::$(git rev-parse --short HEAD)&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Set up Python
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/setup&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;python@v1
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Install dependencies
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
        python -m pip install --upgrade pip
        pip install platformio&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Run PlatformIO
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; platformio run
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Attach artifact
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/upload&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;artifact@v2
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; firmware_esp32
        &lt;span class=&quot;token key atrule&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .pio/build/m5stack&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;core&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;esp32/firmware.bin
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; create_sm
      &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Create Software Module
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cgrotz/hawkbit&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;create&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;software&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;module&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;action@v4
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-tenant&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_TENANT &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-username&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_USERNAME &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-password&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_PASSWORD &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;software-module-name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Beta Firmware
        &lt;span class=&quot;token key atrule&quot;&gt;software-module-type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Application
        &lt;span class=&quot;token key atrule&quot;&gt;software-module-version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; steps.vars.outputs.sha_short &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Upload Artifact
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cgrotz/hawkbit&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;upload&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;artifact&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;action@v2
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;file-path&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .pio/build/m5stack&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;core&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;esp32/firmware.bin
        &lt;span class=&quot;token key atrule&quot;&gt;software-module-id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; steps.create_sm.outputs.software&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;module&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;id &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-tenant&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_TENANT &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-username&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_USERNAME &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-password&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_PASSWORD &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; create_ds
      &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Create Distribution Set
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cgrotz/hawkbit&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;create&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;distribution&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;set&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;action@v5
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-tenant&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_TENANT &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-username&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_USERNAME &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-password&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_PASSWORD &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;distribution-set-name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Beta Firmware
        &lt;span class=&quot;token key atrule&quot;&gt;distribution-set-type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; app
        &lt;span class=&quot;token key atrule&quot;&gt;distribution-set-version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; steps.vars.outputs.sha_short &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;software-module-ids&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; steps.create_sm.outputs.software&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;module&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;id &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Assign distribution set to target filter
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cgrotz/hawkbit&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;assign&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;ds&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;to&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;filter&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;action@v8
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-tenant&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_TENANT &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-username&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_USERNAME &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;hawkbit-password&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ROLLOUTS_PASSWORD &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;target-filter-name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Beta Filter
        &lt;span class=&quot;token key atrule&quot;&gt;target-filter-type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; forced
        &lt;span class=&quot;token key atrule&quot;&gt;target-filter-weight&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;distribution-set-id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; steps.create_ds.outputs.distribution&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;set&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;id &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can go ahead with &lt;a href=&quot;/2020-08-31-esp32_ci_cd_part5&quot;&gt;Part 5 - Connecting the ESP32 to the Bosch IoT Suite&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Preparing the Bosch IoT Suite]]></title><description><![CDATA[This is the third part of a multi-part blog post. You might want to start from the beginning with the first post. I assume you already have…]]></description><link>https://cgrotz.github.io/2020-08-25-esp32_ci_cd_part3/</link><guid isPermaLink="false">https://cgrotz.github.io/2020-08-25-esp32_ci_cd_part3/</guid><pubDate>Tue, 25 Aug 2020 08:13:00 GMT</pubDate><content:encoded>&lt;p&gt;This is the third part of a multi-part blog post. You might want to start from the beginning with the &lt;a href=&quot;/2020-08-23-esp32_ci_cd_part1&quot;&gt;first post&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I assume you already have logged in to the Bosch IoT Suite Console, if you haven’t done this yet, you can follow this &lt;a href=&quot;https://accounts.bosch-iot-suite.com/&quot;&gt;link&lt;/a&gt; to sign up.&lt;/p&gt;
&lt;p&gt;I am  going to use several features in the Bosch IoT Suite for facilitating the automatic distribution of the firmware build using GitHub Actions (The continuous delivery aspect). We are using tags to create a subparition of the device fleet for devices that should receive firmware updates from the CI/CD pipeline. The devices itself communicate with the Bosch IoT Suite using MQTTS, the firmware images are downloaded using a CDN with HTTPS. &lt;/p&gt;
&lt;p&gt;We will need to setup and configure a few specific things in the IoT Suite services.&lt;/p&gt;
&lt;h2&gt;Booking the Device Management Package&lt;/h2&gt;
&lt;p&gt;After account creation and confirmation let’s head to the &lt;a href=&quot;https://accounts.bosch-iot-suite.com/subscriptions&quot;&gt;Subscriptions page&lt;/a&gt;, if you have a newly created account you probably don’t have a subscription yet, and your screen will look similar to the following screenshot:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/dc9cc4ceda279799d8ab181837071fd0/c68a4/3_Subscriptions_after_login.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 41.21621621621622%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABAElEQVQoz41Sy07DMBD0J/ML/Eo/gDN3rlx6RiABVYXUxLGT1PFj7WHXJFEQtLDSahx7H7OzUYkSzKmBfj/ADQNijEgprXjJSikVp2mCMQZ938N7D+WcQ6s1OmvRtC16xokfLOM4jjXxmi8mzeVblZyBTKAYUJitPGS52zD5y4nj6zRS8KQtnt6OeDl84JldWIYQvo31H8scGogL3u9fcbN7wO3dY/XRx7kYKlMpmmcGiYgTv5oQnys7RjFPGY1LUCKqsHKMsggRdw1iLeUsOnedhjYWIXETbiD6SpOBF1klmhspuZREKezO51W/ZdwfY2+WscXF1bVf4reEciFmsU/mMnJ1Hi1ZywAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;3 Subscriptions after login&quot;
        title=&quot;3 Subscriptions after login&quot;
        src=&quot;/static/dc9cc4ceda279799d8ab181837071fd0/fcda8/3_Subscriptions_after_login.png&quot;
        srcset=&quot;/static/dc9cc4ceda279799d8ab181837071fd0/12f09/3_Subscriptions_after_login.png 148w,
/static/dc9cc4ceda279799d8ab181837071fd0/e4a3f/3_Subscriptions_after_login.png 295w,
/static/dc9cc4ceda279799d8ab181837071fd0/fcda8/3_Subscriptions_after_login.png 590w,
/static/dc9cc4ceda279799d8ab181837071fd0/efc66/3_Subscriptions_after_login.png 885w,
/static/dc9cc4ceda279799d8ab181837071fd0/c83ae/3_Subscriptions_after_login.png 1180w,
/static/dc9cc4ceda279799d8ab181837071fd0/c68a4/3_Subscriptions_after_login.png 2402w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;Empty subscriptions overiew after login&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/2a81060a941caadf81f65d5a2f1bed7b/c68a4/4_Subscription_Creation.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 45.27027027027027%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABBUlEQVQoz41S7WrDMAz0+z/AYOyNNhi0UPZjsJ+J46TLh2On8UdultqE4rVbBUecRJbudBLeOfjThGmaYK3FMAyMEAKuY1mWu6Bcuh9jhGi0xaf8hjEGbdtysa7r+J0SKNl7zxcfCfEqDZ52R7gQIcsSdV1DKcWoqmpD3/fMghqRklugpkIZj6/uhJDYuHm+25mY/gcuKEeHfW1Z3pBYaK23OZL0Vf6jId5Kg+ddw5I1FUoF9QVUlKSO4/hLLp3pW24QMzw05x80fEeup2eOOY2DVNxyfj0zw/fK4GXfYPYBKg0/N6UoCkgpN2NWdoR1ta43QJSJ4ccx7dClW4x/71tuQs70B9FTvP0BO6hRAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;4 Subscription Creation&quot;
        title=&quot;4 Subscription Creation&quot;
        src=&quot;/static/2a81060a941caadf81f65d5a2f1bed7b/fcda8/4_Subscription_Creation.png&quot;
        srcset=&quot;/static/2a81060a941caadf81f65d5a2f1bed7b/12f09/4_Subscription_Creation.png 148w,
/static/2a81060a941caadf81f65d5a2f1bed7b/e4a3f/4_Subscription_Creation.png 295w,
/static/2a81060a941caadf81f65d5a2f1bed7b/fcda8/4_Subscription_Creation.png 590w,
/static/2a81060a941caadf81f65d5a2f1bed7b/efc66/4_Subscription_Creation.png 885w,
/static/2a81060a941caadf81f65d5a2f1bed7b/c83ae/4_Subscription_Creation.png 1180w,
/static/2a81060a941caadf81f65d5a2f1bed7b/c68a4/4_Subscription_Creation.png 2402w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;Create new subscription view&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/9b8674b7b797f1e0ed5cf67b333ccc78/c68a4/5_Subscription_Creation_DMP.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 49.32432432432432%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABVklEQVQoz4WSS07EMAyGe1NuxJqTsGDBmiXcACG16UxfmbRJ82jyY2eaYTQawNInu3Lq/I5dvQkNMUgss4KUEtM0Xfw4jui6DqfTKcPfzETYdcU9qzqpcKSfVjoQY0QIAdu2Zc845y4x51NKWJ3H6gN8THBbJBI8wblqnCSp6OGszYXYOHFt5WueZ4xDD2k3HHQgPMTi0ZJvyQe6oJpIYV03UErBe78XPFOCtNP3PZ2t9+R9q2Yl0dRfdPMRRs/w1sCahbyGodZYDbfFRfhp2rY9t753cks1jgOEaKgdRS3T+wWSTnDs6QlsiNi4AKG1zpQnuVswBAc5DaSwg16obbfSBHVWeq2QCwoh0DRNVvhry8aYvBJlginFKxLifvPPaJDP3sIDzQojr8ZqqNWAvyxdCiOvEg9xWZYcM3bfkurx+R0PT694+fiE0wqWkpz4j7KbRVmxb/pODE68yBLwAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;5 Subscription Creation DMP&quot;
        title=&quot;5 Subscription Creation DMP&quot;
        src=&quot;/static/9b8674b7b797f1e0ed5cf67b333ccc78/fcda8/5_Subscription_Creation_DMP.png&quot;
        srcset=&quot;/static/9b8674b7b797f1e0ed5cf67b333ccc78/12f09/5_Subscription_Creation_DMP.png 148w,
/static/9b8674b7b797f1e0ed5cf67b333ccc78/e4a3f/5_Subscription_Creation_DMP.png 295w,
/static/9b8674b7b797f1e0ed5cf67b333ccc78/fcda8/5_Subscription_Creation_DMP.png 590w,
/static/9b8674b7b797f1e0ed5cf67b333ccc78/efc66/5_Subscription_Creation_DMP.png 885w,
/static/9b8674b7b797f1e0ed5cf67b333ccc78/c83ae/5_Subscription_Creation_DMP.png 1180w,
/static/9b8674b7b797f1e0ed5cf67b333ccc78/c68a4/5_Subscription_Creation_DMP.png 2402w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;Select the subscription plan (at the moment only free plans are available)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/80c169da5134a2c0afcea1932d6b71e3/c68a4/6_DMP_Creation_Last_Step.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 49.32432432432432%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABEElEQVQoz5VSy27DIBDk/+899UOqqof+Qg5VrunJkeU3EGMb8MSDhYMqIjUrjYA1zM7OWlhrsSwL5nkO4D7Guq4HcpHm4z3RNA2qqkLf9wFSykBKpIQxx6IUQTC4GmMwTRO89xBKKbRtGxLjOG4PJnRdh2tRwDl3EDLHYsMwBIK6rgM5zxSktd4JueFFquPHfoPUNwxqz7MgCUieBh8Tf+0QfESFBMlHM0HNNoBntpT6mPM0tUbEoaS+vBJZhfQnDiUOw/v1aCkHWhDvcpVq707kKv4H7KYsy1AUq4fuajRlAWGsx+I8qfDkd3saLgzGodMGH6dffJ4uEIvb5PtHG6+A6sx4w+Va4+3rB+/fZ9wBpo8PUlVz1mUAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;6 DMP Creation Last Step&quot;
        title=&quot;6 DMP Creation Last Step&quot;
        src=&quot;/static/80c169da5134a2c0afcea1932d6b71e3/fcda8/6_DMP_Creation_Last_Step.png&quot;
        srcset=&quot;/static/80c169da5134a2c0afcea1932d6b71e3/12f09/6_DMP_Creation_Last_Step.png 148w,
/static/80c169da5134a2c0afcea1932d6b71e3/e4a3f/6_DMP_Creation_Last_Step.png 295w,
/static/80c169da5134a2c0afcea1932d6b71e3/fcda8/6_DMP_Creation_Last_Step.png 590w,
/static/80c169da5134a2c0afcea1932d6b71e3/efc66/6_DMP_Creation_Last_Step.png 885w,
/static/80c169da5134a2c0afcea1932d6b71e3/c83ae/6_DMP_Creation_Last_Step.png 1180w,
/static/80c169da5134a2c0afcea1932d6b71e3/c68a4/6_DMP_Creation_Last_Step.png 2402w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;Confirm the subscription creation&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The provisioning might take a few minutes. Afterwards you will have Bosch IoT Things, Bosch IoT Rollouts, Bosch IoT Hub and Bosch IoT Manager booked.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/e1dad3580462219e2b26aae4dfce9ffa/c68a4/7_Subscription_Overview_with_DMP_provisioning.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 49.32432432432432%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABRklEQVQoz61STU/DMAzN//8FHDmgiX8AEtMOMMEBCQFioE1iu7CxrmvVNG2T5qMPu2OjTBx6wNKTE8d5ebYjSmuhXqdQF0O45Sf6WtM0rXfOIU1TZFmGoiggjDHYxjESAgcZVVVBSok8zw8X2R+DLYQAS6IYTC5qWhRlhZzYZa7aA+896rpu138RHYNJOZ/vCXgLeANYTfo1SiLmw25pfUkpG+Jxscbp6BnnNxMMrieIU4ngXd9O7tAEIg2Qhkq+f49wMnzB4HaGs/EMsqoPyvhV9lwK98cSwrcijnEbfYda0UYEa6CSiCI7VdF63Q6DTaldT3lQq+USq2iD2geqwFMlW2hdIHm7RLUYQc+v4DdPRBgaepkUUKIjRTx6rfWvr9Gd6k+xrNJBfjxgs7hDMh/DxFMayj+b6P6nfa/Y94az7RAZrPgLDQ8L2kqvov8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;7 Subscription Overview with DMP provisioning&quot;
        title=&quot;7 Subscription Overview with DMP provisioning&quot;
        src=&quot;/static/e1dad3580462219e2b26aae4dfce9ffa/fcda8/7_Subscription_Overview_with_DMP_provisioning.png&quot;
        srcset=&quot;/static/e1dad3580462219e2b26aae4dfce9ffa/12f09/7_Subscription_Overview_with_DMP_provisioning.png 148w,
/static/e1dad3580462219e2b26aae4dfce9ffa/e4a3f/7_Subscription_Overview_with_DMP_provisioning.png 295w,
/static/e1dad3580462219e2b26aae4dfce9ffa/fcda8/7_Subscription_Overview_with_DMP_provisioning.png 590w,
/static/e1dad3580462219e2b26aae4dfce9ffa/efc66/7_Subscription_Overview_with_DMP_provisioning.png 885w,
/static/e1dad3580462219e2b26aae4dfce9ffa/c83ae/7_Subscription_Overview_with_DMP_provisioning.png 1180w,
/static/e1dad3580462219e2b26aae4dfce9ffa/c68a4/7_Subscription_Overview_with_DMP_provisioning.png 2402w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;DMP subscription after creation in provisioning state&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/8a57864f4746198007727388c803e5f4/c68a4/8_Subscriptions_with_DMP_provisioned.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 49.32432432432432%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABZklEQVQoz5WTzUrDQBSF49JXENGFr+DCZ9GNW7WKOxcivoQUXFgaIggVfQBFKKQWddmKtdhFN/1LazWdpPmZmRxnpk0JlUJ74UIG7nz33HsmGmUMfhDCcVw47hBxRFE0dzLJ8H1QSqFFLASoD4SeSschCIJgYSjnXN6AVqp3YOTLuH2uIFf4QLdvi44UsyOafHEBogLERFLG8eMJhW+1NtKPZRiFKnSzCnsYTIpl13gkOU5ImcJxcWaM/2slZWg89EG+O+Mj0G634LquAhFCFMiyLDQbDVj9X1VjkwGoWI/5XkfmqYT71xquzQqKnw1ojEeqs5QsU0KSO0zucqKEj9Qd6SaWdtLYODawvHuJ7YsHaDM3lYBNO0/H457lXrCWymLzNIf1Qx37mbxweQEnp4EnN0WspnRsnd9h5SCLvav8SGFSxTwRV7dsD+Wmja8uQc0aoEe8kULlqrRfuTdfyh8i+YTi+APFp/bGjjme/wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;8 Subscriptions with DMP provisioned&quot;
        title=&quot;8 Subscriptions with DMP provisioned&quot;
        src=&quot;/static/8a57864f4746198007727388c803e5f4/fcda8/8_Subscriptions_with_DMP_provisioned.png&quot;
        srcset=&quot;/static/8a57864f4746198007727388c803e5f4/12f09/8_Subscriptions_with_DMP_provisioned.png 148w,
/static/8a57864f4746198007727388c803e5f4/e4a3f/8_Subscriptions_with_DMP_provisioned.png 295w,
/static/8a57864f4746198007727388c803e5f4/fcda8/8_Subscriptions_with_DMP_provisioned.png 590w,
/static/8a57864f4746198007727388c803e5f4/efc66/8_Subscriptions_with_DMP_provisioned.png 885w,
/static/8a57864f4746198007727388c803e5f4/c83ae/8_Subscriptions_with_DMP_provisioned.png 1180w,
/static/8a57864f4746198007727388c803e5f4/c68a4/8_Subscriptions_with_DMP_provisioned.png 2402w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;DMP subscription after provisioning&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;When clicking on “Access Credentials” you can retrieve endpoints and credentials information for the various services of the Device Management Package. Please extract the information for IoT Rollouts (Tenant, Username, Password) we are going to need them later.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/f53e5ab83d082ad37506b3713d7993e2/928ed/8_1_DMP_Subscription_Credentials.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABbklEQVQoz3WSO0sDQRSF09sLYmVhqb2Nna2/wcpCKwOCFqkEK3+AhaDgg0AaLewtAqKlKGxhsUvYZLObNY99ZJ857rlh4voaODt3Zna+uffMVCaTCWzbRq/XQxzHcF0XYRhiPB7LmPFgMIBpmui6A8RJgiDw8KZbeHg18PxuoamZeDEcsFX4ybJMRHie50jTVMSxEueLAGmWy8bqZRNzW6dY2b/B/PYZ1mqNKZA/q1aO1fj7OmbAw/ojFnbOsXpQx+LuBTaO734D/2vlTBWw1njC0t4V1o9usVy9xubJ/VfJ9CoIAkRRBM/zZhoOh0gKz8pAlYAXpbC9CB9hUsQJoiTl0VMgQf1+XyC8APaj0UiA9LKcJb0Uv8XTsop1lSE38TaZKW/bsizpO52O3C7VbrdlTh3s+z68QtJ7vlTyp4fcpGkadF0XkGEYaLVaApSn0+1K5rRIidAZ8KfpLJkAipsdxxEA3yXFShSkLAX8BOAZpK/jm4DHAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;8 1 DMP Subscription Credentials&quot;
        title=&quot;8 1 DMP Subscription Credentials&quot;
        src=&quot;/static/f53e5ab83d082ad37506b3713d7993e2/fcda8/8_1_DMP_Subscription_Credentials.png&quot;
        srcset=&quot;/static/f53e5ab83d082ad37506b3713d7993e2/12f09/8_1_DMP_Subscription_Credentials.png 148w,
/static/f53e5ab83d082ad37506b3713d7993e2/e4a3f/8_1_DMP_Subscription_Credentials.png 295w,
/static/f53e5ab83d082ad37506b3713d7993e2/fcda8/8_1_DMP_Subscription_Credentials.png 590w,
/static/f53e5ab83d082ad37506b3713d7993e2/efc66/8_1_DMP_Subscription_Credentials.png 885w,
/static/f53e5ab83d082ad37506b3713d7993e2/c83ae/8_1_DMP_Subscription_Credentials.png 1180w,
/static/f53e5ab83d082ad37506b3713d7993e2/928ed/8_1_DMP_Subscription_Credentials.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;DMP subscription credentials after provisioning&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/3ebf2990e6c5d6522509bd57044ce12f/928ed/8_2_DMP_Subscription_Credentials_Rollouts.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABB0lEQVQoz3WSi4qDQAxF+///Z1Hx/aqKVVsVioLZPYGI222FS2bUOblJ5iK/z77vKp66ruV6vUqWZRKGoXieJ77vq5Ikkb7vZZ5nWZblj7Zt0/OXd2DXdZLnuZRlKXEcqwDzrmkaBT6fT3k8HjKOo8ZhGOT1en0G3m43dUUEgOOqqnQPAAEFYvF+v/8HWiS7OQKGALdtq98od5omjbZG67p+BtKPNE0lCALtpeM4Ktd1ta+0wsSexAjoV4e4oUR+LIpCE3CYfpkzEwaIh0Prn0Epj2kCAsIasbYJW6kkR6y/Thl3DAUAwwCGQwMbnN5yIxDOD+DZIWJiZ4f0Moqi4woBPzt9L/kHAiSq9nier5MAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;8 2 DMP Subscription Credentials Rollouts&quot;
        title=&quot;8 2 DMP Subscription Credentials Rollouts&quot;
        src=&quot;/static/3ebf2990e6c5d6522509bd57044ce12f/fcda8/8_2_DMP_Subscription_Credentials_Rollouts.png&quot;
        srcset=&quot;/static/3ebf2990e6c5d6522509bd57044ce12f/12f09/8_2_DMP_Subscription_Credentials_Rollouts.png 148w,
/static/3ebf2990e6c5d6522509bd57044ce12f/e4a3f/8_2_DMP_Subscription_Credentials_Rollouts.png 295w,
/static/3ebf2990e6c5d6522509bd57044ce12f/fcda8/8_2_DMP_Subscription_Credentials_Rollouts.png 590w,
/static/3ebf2990e6c5d6522509bd57044ce12f/efc66/8_2_DMP_Subscription_Credentials_Rollouts.png 885w,
/static/3ebf2990e6c5d6522509bd57044ce12f/c83ae/8_2_DMP_Subscription_Credentials_Rollouts.png 1180w,
/static/3ebf2990e6c5d6522509bd57044ce12f/928ed/8_2_DMP_Subscription_Credentials_Rollouts.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;DMP subscription credentials after provisioning, rollouts section&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Let’s click on “Go to Dashboard”, this will open up the IoT Manager web ui. From there click on “Things Dashboard” in the upper right corner to bring up the web ui for configuring Bosch IoT Things.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1b1b1e744733568004590e45a400b916/928ed/9_IoT_Manager_dashboard.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABnElEQVQoz32S646TUBSF+/5v4gP4y/jDmFETG5sYmxYYri33MlzaUuAc+NxMW23GxE1WICtnr73W2Sw+fV6x/b7E/vGTdGtRmTaXzYaDGeA4B0wnwxBYuxIrP/Jctbx3Qt6t16x8gy/rb3y1ViyfPrB++siiOJ45dhcU/MEgGJlrQqkeNfT085m+E2pkVJq+Hxl6zaQngZxXE3rQLLjXNL0K3EtrTVXVeH6A63k4rkcUx5wvIjzex824PnMprVhMIjROVyI9DfyKCvwwxotS6ktP0ylOvSIpK+x9hL2LhB84irvTIG5Hkbv1K6WuDqebu04Gu9JkGlss08S2bYLAl2gi3FQYhoEjnC+OXdelbVv+9r8RvJNFWeLv9oRxQpRmpPmBTu6mPnf4+5Akyynr5hVt1/8r+CjWSjRrn7CWTbv7mEN9Iisb8uOFZXBg8+yysV3CvCB5qSma8/W63jp8nFLkGZ7rEO4CieYSCOYNdwJPYmZpKkiIo5C6qv7vsJYFOFlFKq5eJGLT6VfuLJGn+XeR7d6XqG/fj/3z+zddSrBm6zdYhAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;9 IoT Manager dashboard&quot;
        title=&quot;9 IoT Manager dashboard&quot;
        src=&quot;/static/1b1b1e744733568004590e45a400b916/fcda8/9_IoT_Manager_dashboard.png&quot;
        srcset=&quot;/static/1b1b1e744733568004590e45a400b916/12f09/9_IoT_Manager_dashboard.png 148w,
/static/1b1b1e744733568004590e45a400b916/e4a3f/9_IoT_Manager_dashboard.png 295w,
/static/1b1b1e744733568004590e45a400b916/fcda8/9_IoT_Manager_dashboard.png 590w,
/static/1b1b1e744733568004590e45a400b916/efc66/9_IoT_Manager_dashboard.png 885w,
/static/1b1b1e744733568004590e45a400b916/c83ae/9_IoT_Manager_dashboard.png 1180w,
/static/1b1b1e744733568004590e45a400b916/928ed/9_IoT_Manager_dashboard.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The IoT Manager Dashboard, with the various sections. Please also take a look at the corner on the top right. There you can find shortcuts to jump into IoT Rollouts and IoT Things.&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;Configure Namespace in IoT Things&lt;/h2&gt;
&lt;p&gt;Before we can register our device and create the device shadow in IoT Things, we need to register a namespace in IoT Things. Each Thing in IoT Things belongs to a namespace, this way the things with the same serial numbers belonging to different solutions can be differentiated.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/c0586a1753ab6079b785f6b159b546b8/928ed/11_things_dashboard_overview.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABVUlEQVQoz52RyU7DMBiE8/6PwYk3QEi9owqJqosKaisEbbYmkbLHW9LBYzD0ABcsTZzE4++f3w6Oj094v5uhuLlFdz9DvXrBfh1ju4mx3Jyw2IRYrO38nGDxWmCV1FjnLeZ5h4csxvy8w7F+w6HYYxltEVwADFWNZneAbFr8Z8hBQQnl3gOlDRppoC8XKK3Rdx2GQVgNqOsaXddDCAltfSw+Wd84eU0w4whtNIQUdr+yCa1BW5CxGo35MwU91GQhvw1yRgt3wDzPkaYpsiyDUgrGgikaOAgpigJhGKKqKrfmC3iZrzABH2yv73sHk1I68R+/fXUW5RE0TeNmivCyLN3ctu0P0JsIIIjyrfk0HiKEcGIRP9gJPQ7IBRoGm5BVeJb85zf4s/FddPbSGOA6PYv7AA6Yns8IoxjH08mmaNytDuKzbcJoTpLkW1EUuTYJvb4ksj4AnVW4dAEWK5gAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;11 things dashboard overview&quot;
        title=&quot;11 things dashboard overview&quot;
        src=&quot;/static/c0586a1753ab6079b785f6b159b546b8/fcda8/11_things_dashboard_overview.png&quot;
        srcset=&quot;/static/c0586a1753ab6079b785f6b159b546b8/12f09/11_things_dashboard_overview.png 148w,
/static/c0586a1753ab6079b785f6b159b546b8/e4a3f/11_things_dashboard_overview.png 295w,
/static/c0586a1753ab6079b785f6b159b546b8/fcda8/11_things_dashboard_overview.png 590w,
/static/c0586a1753ab6079b785f6b159b546b8/efc66/11_things_dashboard_overview.png 885w,
/static/c0586a1753ab6079b785f6b159b546b8/c83ae/11_things_dashboard_overview.png 1180w,
/static/c0586a1753ab6079b785f6b159b546b8/928ed/11_things_dashboard_overview.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The IoT Things dashboard after login&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Please head over to “Namespace” and register your namespace. In my example I am using the namespace “de.cgrotz.test&lt;em&gt;namespace”. In the IoT Suite, thing IDs consist of a leading namespace and for example the device ID, e.g. de.cgrotz.test&lt;/em&gt;namespace:device_123.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/89490dbf8240a56ed1c13172dabb3641/928ed/12_things_namespace_configuration.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABZklEQVQoz6VS20rDQBDNf/rmL/nis0/iD0ih76UIll5ssS2S9JJ7qUk2e98cJwlSQRDRgcPZy8yZ2Zn1dk/PCB6HyO/uwQZDFLMVNrMjli8hpos9JosDJnPiVYTJW45ZVGCeVRhnDKM0xDhZY1f42OYbTI9LeA5AfT6jXG8hywp/MckVlFDd2jNaQyoF3TRQtH6vBCpy4JyjKAowVkMICaU0HPlY18C5nm3jYKyFNhpCCopX8BpyMsagFbbE7f6b0VnzA1pzzsGSeCeYpimiKEIYhpBSdpdtkt/a1xI6wVYoCAIEvt+xT1yUJRghj2OcKGFVlah5jbq+oG2LMxJWE+jZzadgRgFxnCBOM0RJijQ/QVMLlJIUxKiHNVUuqNcXKBIpSfT1kGK1T5Ccy75C/MOOJ4br2yGubgZ4GG16QVFzcMZo9ByyZcoq6QsoSdOXNH1tehjbw7oOqmNLk7b0VEc/oL3T+AC/L7XQTSFVrgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;12 things namespace configuration&quot;
        title=&quot;12 things namespace configuration&quot;
        src=&quot;/static/89490dbf8240a56ed1c13172dabb3641/fcda8/12_things_namespace_configuration.png&quot;
        srcset=&quot;/static/89490dbf8240a56ed1c13172dabb3641/12f09/12_things_namespace_configuration.png 148w,
/static/89490dbf8240a56ed1c13172dabb3641/e4a3f/12_things_namespace_configuration.png 295w,
/static/89490dbf8240a56ed1c13172dabb3641/fcda8/12_things_namespace_configuration.png 590w,
/static/89490dbf8240a56ed1c13172dabb3641/efc66/12_things_namespace_configuration.png 885w,
/static/89490dbf8240a56ed1c13172dabb3641/c83ae/12_things_namespace_configuration.png 1180w,
/static/89490dbf8240a56ed1c13172dabb3641/928ed/12_things_namespace_configuration.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The registered namespace&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;Create new Device&lt;/h2&gt;
&lt;p&gt;Let’s go back to the IoT Manager and register our first device. After device registration IoT Manager provides a JSON config file to you, that contains everything the device needs to connect to the Bosch IoT Suite.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/bca0103099b54ac9ea6139aa80e2786f/928ed/13_iot_manager_device_management_empty.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABnklEQVQoz5WQO1MbMRSF9/8XqVOlpElmCBShAcOaGQgmhjEFBhzvy8Yb8HqfkvYhyYerFRMIXe7MpysdSVdH1xkeX2A+/oX7yyvEt/coZnO0d1Nw/xFPyxxBlODBX+P3IsM8YfDKFgdBjK/TKW4WM/ycjjCaT3B1foTbswGcbxMPI3+FJM+RMYF2C1QKuI5znIdrPDznaBoBITgEZ6gZQ1Uy5AUnGHglwFkNVnJUpDnfJz7GXkybFdZZgU2Ww1ut8Xl/gE87e/iy+wMnwyGOXbdnYDKt3VPX6kO353BwhIvxGE4ULfBnuUCSbJCmKYospYLP8KJHLL0ZIt9D4PsIgwBhGP6dmxxQjkgzerxaoWLkMCXLSilovYXe0n8JITWe8oq+VqIkiqJA+Q6r2zmnFrRNA60kOqrj1IqKUNjRRqc0NrVEq4Ga+tnoN8x5w/u1kNZE2XRwRKdtQXJmMNFSwUR0fRZSoabDb6gPWL0heGccSo2P0dKrFW3+bygy5HByaJwpbdB9L83LRSN7XZKm/oE06lUnJWX9es/237TqBWXVqK9hRIZ1AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;13 iot manager device management empty&quot;
        title=&quot;13 iot manager device management empty&quot;
        src=&quot;/static/bca0103099b54ac9ea6139aa80e2786f/fcda8/13_iot_manager_device_management_empty.png&quot;
        srcset=&quot;/static/bca0103099b54ac9ea6139aa80e2786f/12f09/13_iot_manager_device_management_empty.png 148w,
/static/bca0103099b54ac9ea6139aa80e2786f/e4a3f/13_iot_manager_device_management_empty.png 295w,
/static/bca0103099b54ac9ea6139aa80e2786f/fcda8/13_iot_manager_device_management_empty.png 590w,
/static/bca0103099b54ac9ea6139aa80e2786f/efc66/13_iot_manager_device_management_empty.png 885w,
/static/bca0103099b54ac9ea6139aa80e2786f/c83ae/13_iot_manager_device_management_empty.png 1180w,
/static/bca0103099b54ac9ea6139aa80e2786f/928ed/13_iot_manager_device_management_empty.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The device managemnt section of IoT Manager without any devices&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/39ab55845822d691ae86774c9c629049/928ed/15_iot_manager_new_device_filled.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB3ElEQVQoz5WQy28SURSH+TPrBogghgrlNenwmAdoHxvSTRNFY0cQk2IT966MbrpxoW7UuDIuurDK0GEYKDB8njulpi69yZd7zpm5v985J5ZIpMlnMuRSaUrlGtp+B+3BIfmdJ2T2HFK7T4UjUvsO6XaP9EGfeNsh2e5Qfii5Viadu0MmFWcrc5tYYnOLXFmjUCpy1HvO+TjgzPUYBpeMppd4s0XExXSOd00wZyy1EOg8foZWqVCvNTAaJrFkNk++pFEsluiJYOD7eKMRI3eI73nMplNmQXB138D3x/z46dLa2WXj1gbxZIK72Syxgggph0KhQLfbZTKZ4Auj0QVBMGWxXDJfLFisUfFSap4fcHz6DXuvTf7eJhXRMEzpUK/VsW0bXdcZDAaoE4ZhxGq1+odQEV6xXIbRv47joGkatmXRbLaINUyLVquFXq1ycnLC/56urKmyrdOwbAyrKYKGKcpNqiLY7/fxZG/D4XCNi+u6nP/6zZfvZ7x+/5UXbz7w8t0njt9+5NXpZw4OH0XNqMbMqEMRVCPbthXdLRE3xa2uOpdYmam6ISNt1w0qeh2t2viLqUZV7y016X1idRG0JFEfTOUii1W1qjyO6pKruoqVafPafJ3ffGvL6v4AbDgfHHSsY6YAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;15 iot manager new device filled&quot;
        title=&quot;15 iot manager new device filled&quot;
        src=&quot;/static/39ab55845822d691ae86774c9c629049/fcda8/15_iot_manager_new_device_filled.png&quot;
        srcset=&quot;/static/39ab55845822d691ae86774c9c629049/12f09/15_iot_manager_new_device_filled.png 148w,
/static/39ab55845822d691ae86774c9c629049/e4a3f/15_iot_manager_new_device_filled.png 295w,
/static/39ab55845822d691ae86774c9c629049/fcda8/15_iot_manager_new_device_filled.png 590w,
/static/39ab55845822d691ae86774c9c629049/efc66/15_iot_manager_new_device_filled.png 885w,
/static/39ab55845822d691ae86774c9c629049/c83ae/15_iot_manager_new_device_filled.png 1180w,
/static/39ab55845822d691ae86774c9c629049/928ed/15_iot_manager_new_device_filled.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;Registering a new device&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/abee206179308a9124d2b5c2b2092c0a/928ed/16_iot_manager_new_device_result.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAACEUlEQVQoz0WRWW8SYRSG5x96ZyQGQbpYoGzTwsDstMVr09/gTe+8ckuMxqapS6Jd6MJuaYcWKC1Yo4lePJ4ZRS/efF8y8z55zvmUSGSW1Nw8i5KlxCLFVBo9mWRuscjdtE0oZXFHEso4hJbLhApr3Moa3JZ/FnIpZpKzzKYXmI+FSc/HUCKJNImsSl7T0HQDw7KwVys8fb/Lq70mrw9O2Kx7bNbOeHN4wnbrgucfamhFQ1JCLxno0ivJ3TQslGg8RTKjomlFChJ1aZmSYdJs1Lke9hkNLrgZX/Hj21e+30zg10/arQ6xmRiRaJTI/Whwhu+FeRCPo2SyOdRcjny+IFBNzmUxNfn46TNHR8e02m26p2d4Xg+vd87V9ZhavY6q5shkMuSyWbISVVUxZTpFK+lY/pi2je04WKbJaqXCzl6Veq1GXcqNRoN+X2xHIyaTCc1mE0PXKYqArvujGkHPdcsohmXjCGgaH74mwP2DQ2oCbLc7dLtdBoMBl5eXjMdjmq0WlpR16Rq2g8/QTQvTdgUoFx/kG/4Drk2Bx4GdDxwKcDQccjMZyw4F6LgBxIdNgdYfQ+u/oev+NXxIq/OFnucJ7DSw610MaJ+e4w2vOWp0WF0p44iEO+3KvVxeQdFlh7a/A4ktz2/6u5APm1vbVKtVdnZ3qe7v8/LtO9Y3nvFo4wXrj58EIP8RLAEF8cXE8DePlfoLm5PyegAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;16 iot manager new device result&quot;
        title=&quot;16 iot manager new device result&quot;
        src=&quot;/static/abee206179308a9124d2b5c2b2092c0a/fcda8/16_iot_manager_new_device_result.png&quot;
        srcset=&quot;/static/abee206179308a9124d2b5c2b2092c0a/12f09/16_iot_manager_new_device_result.png 148w,
/static/abee206179308a9124d2b5c2b2092c0a/e4a3f/16_iot_manager_new_device_result.png 295w,
/static/abee206179308a9124d2b5c2b2092c0a/fcda8/16_iot_manager_new_device_result.png 590w,
/static/abee206179308a9124d2b5c2b2092c0a/efc66/16_iot_manager_new_device_result.png 885w,
/static/abee206179308a9124d2b5c2b2092c0a/c83ae/16_iot_manager_new_device_result.png 1180w,
/static/abee206179308a9124d2b5c2b2092c0a/928ed/16_iot_manager_new_device_result.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;After creating a device you are presented with a JSON data structure that contains the necessary information for connecting the device&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;Create Rollouts tag&lt;/h2&gt;
&lt;p&gt;If we later want to be able to select common devices, for example devices belonging to our beta fleet. In order to do so, the Device Managment Package has the concept of tags. Tags need to be created in IoT Manager first, and can then be assigned to devices. Tags can be queried in IoT Rollouts Target Filters for selecting Deployment Targets that for example fulfill certain requirements (e.g. the Beta Tag we just created).&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1bd43ed674718053862d05d3c3d1693b/928ed/19_iot_manager_dm_grouping_dropdown.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABmklEQVQoz5WQy2/TQBDG/f8fuHPhyAUkBIiilibgIBEIeSitRNKExI8Ep2lM68fueu3d9cesLdG04sJIP30zn1fjmXFOz/uYD4a4+j5GPF9Arj3I+Qzc+4X9NoEfxlh4B/zc3GEVM6yzEu/9HV7MZrjYLPF1NsBgNcW438GPL1044f4ah9sYd1mCy32K8UFA1MBkl6AfHLC4SSAleYJDcIaCMeQZQ5JygoHnApwVYBlHTp5z4V3januLJTU4nd/g5TTC1I/x9E0XT56/xrNXJ/jU6+Gj6zZ0rVLtfnZbv+c2nHc7+DYawXk39HAyCvF2GOBsssGHSYjOZYRgG2GzWiL01vA9D4HvIwiCv7lVnzQkz/q7KELOaMJSVfhX7JOcVsuQEWmaIjui9duc0wlKKWG0QqU1HK4M6rqGNi2G8kJp/C4USgMUGpDmnkLXDce1UBaDTFZwRGWaiWxTi41SG8SialRQ84Ie36Mf0fqS4BVNaIvHUdJfc/r4v6FpIIdXxysbGNOunErV+Io8/QDy6FaVUqTmwansRn8AIu+ma2iIWq0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;19 iot manager dm grouping dropdown&quot;
        title=&quot;19 iot manager dm grouping dropdown&quot;
        src=&quot;/static/1bd43ed674718053862d05d3c3d1693b/fcda8/19_iot_manager_dm_grouping_dropdown.png&quot;
        srcset=&quot;/static/1bd43ed674718053862d05d3c3d1693b/12f09/19_iot_manager_dm_grouping_dropdown.png 148w,
/static/1bd43ed674718053862d05d3c3d1693b/e4a3f/19_iot_manager_dm_grouping_dropdown.png 295w,
/static/1bd43ed674718053862d05d3c3d1693b/fcda8/19_iot_manager_dm_grouping_dropdown.png 590w,
/static/1bd43ed674718053862d05d3c3d1693b/efc66/19_iot_manager_dm_grouping_dropdown.png 885w,
/static/1bd43ed674718053862d05d3c3d1693b/c83ae/19_iot_manager_dm_grouping_dropdown.png 1180w,
/static/1bd43ed674718053862d05d3c3d1693b/928ed/19_iot_manager_dm_grouping_dropdown.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The grouping section in IoT Manager, dropdown with grouping options opened&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/ebecf080d13f614b5d7d525b9a533e12/928ed/20_iot_manager_dm_grouping_tags.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABjUlEQVQoz5WSS4/TMBSF8/8X7NnMkg0LxCxAQjOFFInAvBCDRKswnSRtp1VfmSR+xI7tHK4TNA1ILLjSp2MfK9c+VwnenUWYXl4hvrzBYRpDJwn0dAKRPGCzLJDO94iTHe4Wj5jtOe4rjbfpGi8nE9wufuLz5AIXs2+4ic7x49MIwWy1wnK7xSbPcbXMEa05ysbh67pAlO0QbwsoJSGlgBQcNedgFUdRCoJDMAnBa/BKgJEXLHYHMKkgVIPvG4Zo/ohVzvD8dIRnL17j5NUbfBiP8T4MO0ZeaR9+DHt/HHacjc7x5foawcM+h9EawzKuRbZcYTGLMU/ukdIYsjRFlmVPa68p6Zw8768pKeP0wtq4rknbtnCEV21bbApG0SpURFmWqAb0fr8WNAKtFJw1aKxFIAcNPb60dTjUBpqOagsod6SmyzzDvTQeh4rG9s+Ge9l0Ko2FT3HE/kXvK0I09hh5WD4yo8P/LUsPCgT9Iv5l1nkcHKm/uVSm8w159g/Io1k1xpC639/18/eJfgG7t6ptYyURUAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20 iot manager dm grouping tags&quot;
        title=&quot;20 iot manager dm grouping tags&quot;
        src=&quot;/static/ebecf080d13f614b5d7d525b9a533e12/fcda8/20_iot_manager_dm_grouping_tags.png&quot;
        srcset=&quot;/static/ebecf080d13f614b5d7d525b9a533e12/12f09/20_iot_manager_dm_grouping_tags.png 148w,
/static/ebecf080d13f614b5d7d525b9a533e12/e4a3f/20_iot_manager_dm_grouping_tags.png 295w,
/static/ebecf080d13f614b5d7d525b9a533e12/fcda8/20_iot_manager_dm_grouping_tags.png 590w,
/static/ebecf080d13f614b5d7d525b9a533e12/efc66/20_iot_manager_dm_grouping_tags.png 885w,
/static/ebecf080d13f614b5d7d525b9a533e12/c83ae/20_iot_manager_dm_grouping_tags.png 1180w,
/static/ebecf080d13f614b5d7d525b9a533e12/928ed/20_iot_manager_dm_grouping_tags.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The grouping section, with Tags selected&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/71c88c74dc145505289bdf8bd8918081/928ed/21_iot_manager_dm_grouping_tags_new_tag.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB00lEQVQoz32RTU8TYRSF++t040IxgUYoVAoFbOeD+Z73Yz5YSkh0w86NiSFhAZq4EEiMYeMvaNnUTvU3uBApHM87JcjCOMmTOfPOvSf3nrfRanXQX18nXYQ9C8J2oHo9CMdDsB3DcUP0nRAWtRUKOKnCkuNjnjWb2xY6vTWs2ZvorrZgd1fRsD0PXhAgiCL0/QhWlCJRGTb8BB2a2VGCXCtoJWsyIoVAnAgkRKRESKRJCiU1Gn4YIeWBkBJ2ENM0hk+TR81lPHzaxIO5Bcw1F/GEmPfjhWeYX1xC+3kbK4b2jNZyCxtbWzNDpRTyPEdZ5NgpCugsg8vJnd4L7L45wOsP53h5eIrdwzO8en+OvbdHsK0+XNe9w2O90pxQKl2bZTQx5ESRkCuEjGIwGMA8v35f4fJqWuvq+w8Evo80TbmyWdXEoVAU5T8MqZXOEDOPmFEMLy5qk+l0Sq5rPR5XiJmdygpInZMMgj7m+/+GbBoMh7XJNQ1xMzOcTCpE5hJYJ28xhvr+hPcxKwsWmVVGo9Fswhvg5yWnpB5Vk/pfwbzv+thTljtoGGczmb7FaMlwU55LNp2cnqEaf8PHL1+xd/AJ+8efsf/umBfJ3PTfHqPzssQfznnV/ZIBWF4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;21 iot manager dm grouping tags new tag&quot;
        title=&quot;21 iot manager dm grouping tags new tag&quot;
        src=&quot;/static/71c88c74dc145505289bdf8bd8918081/fcda8/21_iot_manager_dm_grouping_tags_new_tag.png&quot;
        srcset=&quot;/static/71c88c74dc145505289bdf8bd8918081/12f09/21_iot_manager_dm_grouping_tags_new_tag.png 148w,
/static/71c88c74dc145505289bdf8bd8918081/e4a3f/21_iot_manager_dm_grouping_tags_new_tag.png 295w,
/static/71c88c74dc145505289bdf8bd8918081/fcda8/21_iot_manager_dm_grouping_tags_new_tag.png 590w,
/static/71c88c74dc145505289bdf8bd8918081/efc66/21_iot_manager_dm_grouping_tags_new_tag.png 885w,
/static/71c88c74dc145505289bdf8bd8918081/c83ae/21_iot_manager_dm_grouping_tags_new_tag.png 1180w,
/static/71c88c74dc145505289bdf8bd8918081/928ed/21_iot_manager_dm_grouping_tags_new_tag.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;Create a new tag, please keep in mind that the tag ID also needs to lead with the namespace we previously created in IoT Things&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Now let’s head back to the device management section and select the device we previously created&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/af3d6150e39d291923079bfae075b9ee/928ed/24_iot_manager_dm_device_selected_scrolled_to_tags.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB00lEQVQoz5WSS28SYRSG5wf7R1zopkvd1IU20ZgKNsbalqKpDMMItlII0LFcCwxzvzHMMPP4jW1NGt14kifv956cxbl8UrVS50pV6TWazDs93IFG3O1iX00ZDi204YrxxGQ695g5EZMw4cNwzhtRczEZIHcVFO2cVu2Y7tcKUrl9TVMUGLaNHURscggz8OOYOI7QvYD6SEe+XnKmLRgsLCI/xHZDXDcg9COicI0nvGP7SEedMZfjBWEQ4PoBjuMwWxq8/1ShVCqxf3jCzusDnr7c58mrd7woH1KpnnJyWhGcclyo8B+PjvhSk5Eu+9f0tRHaZEF/NGcwukHtTRjrFpZlEq/XkG0hv2ObkiQbQfKAVBBvEiS5f8M3Ted8aKJcrZD7utiJwf9EfqdpliNl/ygocrutKc/VMc8Ee+0lVpQQbFK8dfIbP04Ft3ofyTZDipKMPM/ZZrcU7yjZ0lk4/NQdurOVOITJ0nLQbRe9UEHhV8LPDZvHZZVHu1XeNjSkOP27x1TMYLoegW3gOxaebWKZxh/sexU7NgyDvc8X7BwonHUnosP0YYdZllEM0dGGVMUF63UZRamjNMR/UxQaQoucLNeoi7zaVOm3v9P70cLzPH4BikCXVWu/4yIAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;24 iot manager dm device selected scrolled to tags&quot;
        title=&quot;24 iot manager dm device selected scrolled to tags&quot;
        src=&quot;/static/af3d6150e39d291923079bfae075b9ee/fcda8/24_iot_manager_dm_device_selected_scrolled_to_tags.png&quot;
        srcset=&quot;/static/af3d6150e39d291923079bfae075b9ee/12f09/24_iot_manager_dm_device_selected_scrolled_to_tags.png 148w,
/static/af3d6150e39d291923079bfae075b9ee/e4a3f/24_iot_manager_dm_device_selected_scrolled_to_tags.png 295w,
/static/af3d6150e39d291923079bfae075b9ee/fcda8/24_iot_manager_dm_device_selected_scrolled_to_tags.png 590w,
/static/af3d6150e39d291923079bfae075b9ee/efc66/24_iot_manager_dm_device_selected_scrolled_to_tags.png 885w,
/static/af3d6150e39d291923079bfae075b9ee/c83ae/24_iot_manager_dm_device_selected_scrolled_to_tags.png 1180w,
/static/af3d6150e39d291923079bfae075b9ee/928ed/24_iot_manager_dm_device_selected_scrolled_to_tags.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;When scrolling down in the device details, you can see tags assigned to the device&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Assign the tag we just created to your device.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/b5d7ba024b7ce902ac8dcab8b3bb741b/928ed/25_iot_manager_dm_device_selected_assign_tag.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB7ElEQVQoz2WS3W4SQRiG97I89diTHlgTodI2LCyy3T92gWV32YWlHmkxjaT34A145i0Yoi2VCzC2SWOwxpgAy+PHQhtNJ3kzk8l8z7zzfqMc7quY1SpGRcPTj+iYFtHREW2zgWO3MU0Xy3SwbQ/Ha9HwO+ybNs/rNep2HVVXqVgv0colLK2MUqjbaHK45fv4QUg36REmCUEUEYYB3uA1+vEptd7JvbTkBDUeoveHdKKESOp8P5DzXZSS7qA7HkEQ0BH5AnabbYqlA3af7fL+w0e+Xt9y+X3G5dXPrWZMZW/y7QZPHBeKRV6U9lE1DaVuWBiWgylQQ5yatkvVaNBo+Xiuy+Tigs1Y8WBkC0ajUW4ijrskvR6KarhoZpOa5FUxW6hGUzJpkfRT0l7CdDrNa5fLJdlqtVG2yvHz+ZyzszN5akhPYP10gLKmHqd9BqL1/GqQyk0JJb1BQTP59Pl8A8wyVgK7Ezlwwem7EVEU5rX9NEUJuzGJNCHear2OZM9q+hKDy5fzzZMzAbKFrdd3Dt+cvOXx00Me7RywV3NQojjJ7f6rWDrd7kiH3QaTyeQe+CDFbMlwOGRnT+VJsUrVaorDOPnPYS6BGpZNsVhgPB7fZ7h2uFhmXM9+c/PrD1c/bnMDtUoZQ/5ltxvxF5Se/bt3nabUAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;25 iot manager dm device selected assign tag&quot;
        title=&quot;25 iot manager dm device selected assign tag&quot;
        src=&quot;/static/b5d7ba024b7ce902ac8dcab8b3bb741b/fcda8/25_iot_manager_dm_device_selected_assign_tag.png&quot;
        srcset=&quot;/static/b5d7ba024b7ce902ac8dcab8b3bb741b/12f09/25_iot_manager_dm_device_selected_assign_tag.png 148w,
/static/b5d7ba024b7ce902ac8dcab8b3bb741b/e4a3f/25_iot_manager_dm_device_selected_assign_tag.png 295w,
/static/b5d7ba024b7ce902ac8dcab8b3bb741b/fcda8/25_iot_manager_dm_device_selected_assign_tag.png 590w,
/static/b5d7ba024b7ce902ac8dcab8b3bb741b/efc66/25_iot_manager_dm_device_selected_assign_tag.png 885w,
/static/b5d7ba024b7ce902ac8dcab8b3bb741b/c83ae/25_iot_manager_dm_device_selected_assign_tag.png 1180w,
/static/b5d7ba024b7ce902ac8dcab8b3bb741b/928ed/25_iot_manager_dm_device_selected_assign_tag.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The assign tag menu&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/b7c53d2620d4ede5791ffa259d0e5181/928ed/26_iot_manager_dm_device_selected_tag_assigned.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB0UlEQVQoz5XSSW/TQBTAcX9hPggHuCBx4lA4AFKRKCkIKGmTgBo7u9omTbNYWZs4aeLdjmPH/jNpgqoKLoz003szehq9WaRcpkC3XKZVqjK9bmF1VIJmE6M7pt/XUft3DEdLxlObW9Nn5IV87U/5IGouRx2UZpGiekFNPqWZzyAd13tURcHCMDBcn3UCXgxOEBAEPnPbpTCYo/RmnKsaHU3HdzwMy8OyXDzHx/dW2GJuGg5S+npIY6jhuS6W42KaJrezBZ9/ZEilUhydnPHi8AvP3x7x7N0n3hyfkMllOctmhCyn2yjm39NpfskKUqPdo60OUEca7cGUzmBCuTViONfR9SXBagXxBpK9TUQYroXwkUgI1iGS0p5QUedc9JcUu3co7bm4kwX/M5J9jOIEKf5HwXbtdW3MgfCqMuJ9fYbuh7jrCHsV3nOCSNjFPyPcxEh+GJMkCZt4Z5v74YamZlLuadR6U7raEm1pMtP3ljtzkU8WBk9TZZ4c5PhYUpGC6O8eQ7Gx5XpcdQZMpjMCxxIvqGOJn3DPfKDrOofnDV5+q5C/GYsOo8cdbuKY7SHq3R75n1lKpQKKolAoPFAUGVnOI4v1UqXEzVWN5mUVy7b5DVhBlv5HGLeQAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;26 iot manager dm device selected tag assigned&quot;
        title=&quot;26 iot manager dm device selected tag assigned&quot;
        src=&quot;/static/b7c53d2620d4ede5791ffa259d0e5181/fcda8/26_iot_manager_dm_device_selected_tag_assigned.png&quot;
        srcset=&quot;/static/b7c53d2620d4ede5791ffa259d0e5181/12f09/26_iot_manager_dm_device_selected_tag_assigned.png 148w,
/static/b7c53d2620d4ede5791ffa259d0e5181/e4a3f/26_iot_manager_dm_device_selected_tag_assigned.png 295w,
/static/b7c53d2620d4ede5791ffa259d0e5181/fcda8/26_iot_manager_dm_device_selected_tag_assigned.png 590w,
/static/b7c53d2620d4ede5791ffa259d0e5181/efc66/26_iot_manager_dm_device_selected_tag_assigned.png 885w,
/static/b7c53d2620d4ede5791ffa259d0e5181/c83ae/26_iot_manager_dm_device_selected_tag_assigned.png 1180w,
/static/b7c53d2620d4ede5791ffa259d0e5181/928ed/26_iot_manager_dm_device_selected_tag_assigned.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The device with assigned tag&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;In the IoT Things dashboard you can see the change to the device shadow, that reflects the assigned tag.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1ad931e50ff2d692eec11288f384e9ec/928ed/29_iot_things_thing_details_2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAy0lEQVQoz6WS2w6DMAiGff8ndV5sanri0DJAa+IuNGYkv7S1+YDCIGo5ZyEiW0opxfcxRgEAP2utXcqs1urroQOXZXG/rqvL9ia72KFXdgKmlDwzO0RC98zs2rK4z/IA2scy6+X92h3oAO7egdM0yTi+hCuJHp9gd9Zv4F6Nl2ylzfMsAd6ScNaf2eFPMuxyIBRQ4Mfj1VZV/Bh0Am6dLoLI8q8NOSZJQWdOO51DkKLzVzJok1A7DxqEPBDSLq6HgG1P+jwspE9kE/IF61XHjs9SniQAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;29 iot things thing details 2&quot;
        title=&quot;29 iot things thing details 2&quot;
        src=&quot;/static/1ad931e50ff2d692eec11288f384e9ec/fcda8/29_iot_things_thing_details_2.png&quot;
        srcset=&quot;/static/1ad931e50ff2d692eec11288f384e9ec/12f09/29_iot_things_thing_details_2.png 148w,
/static/1ad931e50ff2d692eec11288f384e9ec/e4a3f/29_iot_things_thing_details_2.png 295w,
/static/1ad931e50ff2d692eec11288f384e9ec/fcda8/29_iot_things_thing_details_2.png 590w,
/static/1ad931e50ff2d692eec11288f384e9ec/efc66/29_iot_things_thing_details_2.png 885w,
/static/1ad931e50ff2d692eec11288f384e9ec/c83ae/29_iot_things_thing_details_2.png 1180w,
/static/1ad931e50ff2d692eec11288f384e9ec/928ed/29_iot_things_thing_details_2.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The device shadow in IoT Things, now with Beta tag assigned&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/2580bbe45cd079ee0921f4238798f1dd/928ed/30_iot_rollouts_overview.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABxUlEQVQozz2RDW/aMBCG+f//Y9Kmbt00VZo6oXbVprVVy4pgUChQSFIyEufTiZ3ECbw7O5BIr5zzx3Pv3fX6gyWGcxtXTysstjHWO95pQ3JY3sn22/UtEO2e3+65kUSwchDvQvQuH17Qf5jhO623ExvDhYvH2Rvu6H/86uHZCvB37WOy8fHihJhaDKOVh+mGmXhJJrRe3Rhzm6F38XuCb3fPuLid0qUd8qLCLsrAYo6iUohS7SRCkGTmLOI5ZrYHL+J0JpBkEnEmkMmSwAT89GOIc9KXn2OM1i5kVVNJCZJcQpQVJMmLNUyZs0LV1BqGjOCiVGZfJypVQy2iks9vhvj6a2yAU9uH2h8QUGYu6VLdkPbwE0GPNayNV//CLtbSiVRzICMpemdXf/DxmkQul9sQ+8MB7Ag8PWApua2OQOMkNu5OMK2q2WMb8LZkrbPrJ1heQg6BMCuozBypKKn0Ei5d1H0NuTCxBspjgg5Izr1YoPe+/4gPpM83IwwWa2yseziWB8YlOPVR1bUB6wGkFJc0qJAXHfAE1e3RRgzw3eW9GcxgbsF2HfjUC5bkZsr602UKanxOk2yotKyokZeqc3eCc6nwH6NzntscJFmEAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;30 iot rollouts overview&quot;
        title=&quot;30 iot rollouts overview&quot;
        src=&quot;/static/2580bbe45cd079ee0921f4238798f1dd/fcda8/30_iot_rollouts_overview.png&quot;
        srcset=&quot;/static/2580bbe45cd079ee0921f4238798f1dd/12f09/30_iot_rollouts_overview.png 148w,
/static/2580bbe45cd079ee0921f4238798f1dd/e4a3f/30_iot_rollouts_overview.png 295w,
/static/2580bbe45cd079ee0921f4238798f1dd/fcda8/30_iot_rollouts_overview.png 590w,
/static/2580bbe45cd079ee0921f4238798f1dd/efc66/30_iot_rollouts_overview.png 885w,
/static/2580bbe45cd079ee0921f4238798f1dd/c83ae/30_iot_rollouts_overview.png 1180w,
/static/2580bbe45cd079ee0921f4238798f1dd/928ed/30_iot_rollouts_overview.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The beta tag in IoT Rollouts with the device as update target&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;Configure IoT Rollouts&lt;/h2&gt;
&lt;p&gt;In order for the auto rollout to work without hickups (especially when testing), I needed to “allow parallel distribution of multiple distribution set assignments and rollouts”. The non hacky approach would be to cancel distribution set assignments on the targets before updating the auto assignment in the target filter.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/8d43e73bbdfa40daefdc2a9e81708514/928ed/31_iot_rollouts_system_configuration.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABi0lEQVQoz42R607CQBCF+/7vYaJGRaOJISF4iyZ4A9QggqC2pZTeu223N/A4uyAqMcYfX2a76Zw5Z1ap3Tyj1VNRbw7QH/l4nUR4MZlEteJ/YXgczlCDb7pQDhtdVBsdVK96uHzU0ewZuOrO6/PIW+Cjr3t/MqD/eqoNpXLaRuX0DvsXHXRVC05IE50QE48hiFOwJEVINStK5OVU1jQniukSTt/F9B069Sk7J23skuju2T06byb8KIXpMrhhgiQrEPEMjIjTnJrnYvwXwXL2TvF9KNvHLRK7I5f3eNIs2H6EgW7jbexCNT1oEx+GHUK3AjhBLId8inwnK2ckGEDZI7GD8wcZu687FDGDSXE9xiURz5dNQmzV3RclNGsRuUJskdOB4cJlCUZ2QNG53GGcFnK6aMrKr4hLocVZ3BluBGW9do0NYuuoCXUSkKuEHEbSZRBnUjAmZ8KdOMt4K+54PpV3LkvngmvVBjbrtxjTY4ydAMPFDjXaodijKvZJiMcKk/mQJPu5QyHMeIEPfTSgDLPEeCEAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;31 iot rollouts system configuration&quot;
        title=&quot;31 iot rollouts system configuration&quot;
        src=&quot;/static/8d43e73bbdfa40daefdc2a9e81708514/fcda8/31_iot_rollouts_system_configuration.png&quot;
        srcset=&quot;/static/8d43e73bbdfa40daefdc2a9e81708514/12f09/31_iot_rollouts_system_configuration.png 148w,
/static/8d43e73bbdfa40daefdc2a9e81708514/e4a3f/31_iot_rollouts_system_configuration.png 295w,
/static/8d43e73bbdfa40daefdc2a9e81708514/fcda8/31_iot_rollouts_system_configuration.png 590w,
/static/8d43e73bbdfa40daefdc2a9e81708514/efc66/31_iot_rollouts_system_configuration.png 885w,
/static/8d43e73bbdfa40daefdc2a9e81708514/c83ae/31_iot_rollouts_system_configuration.png 1180w,
/static/8d43e73bbdfa40daefdc2a9e81708514/928ed/31_iot_rollouts_system_configuration.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The options in IoT Rollouts system configuration. You will need to scroll down to the end of the page for the save button.&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;Create Rollouts Target Filter&lt;/h2&gt;
&lt;p&gt;Next let’s create a target filter. Target filters allow to group update targets using a filter criteria. You can assign distribution sets to target filters for automatic assignment. This means when a target matching the criteria is added it will (with some delay) automatically get’s the distribution set assigned and the update process will start.&lt;/p&gt;
&lt;p&gt;My target filter is filtering on Beta tags with the following syntax &lt;em&gt;tag==Beta&lt;/em&gt;. In a production scenario I would also add a device type since we are building firmware for different target devices.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/a02f9c63f2c4604a789adf2e00e9e41a/928ed/33_iot_rollouts_target_filters.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABOUlEQVQoz52QWU/CUBCF+/9/iFHRiPhAICwGiQGXVkEqKWsoIAXaQpdbunGc3iYkmhjFhy8z99zJmUUoiX28KhNUpAF6MxNjzcLwY8sZLyxMls6vzAyG9VDFRtMh5JtdFBodFB8VNGUVD+8qpN4cojJHZ7REn5ok9KbGIf+qpfqAojzSIFzftZCrv+HmXoY8XsD1fDA/4HHrMM7GdsF2ASw3zTlOqiX/Jr1t5tFGBoRcvY18Q0aWYlfVEMZ7uFT4HeaHP2oONffDiNY3IVzeviBba+Gq1oYyXaeGVOgF0Z9JjINoD3W1hZCpiLioEmTcn+kHQ3YkfhRjrlvphAmZqkQ3MLkh+49hGEMzXQinpSeclZ9pSgnTlUWjx7zg2JV3dEPd9lLDk0IT52URC8Pmx3V3x0+YGFsswCf5AqR/2wYEnAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;33 iot rollouts target filters&quot;
        title=&quot;33 iot rollouts target filters&quot;
        src=&quot;/static/a02f9c63f2c4604a789adf2e00e9e41a/fcda8/33_iot_rollouts_target_filters.png&quot;
        srcset=&quot;/static/a02f9c63f2c4604a789adf2e00e9e41a/12f09/33_iot_rollouts_target_filters.png 148w,
/static/a02f9c63f2c4604a789adf2e00e9e41a/e4a3f/33_iot_rollouts_target_filters.png 295w,
/static/a02f9c63f2c4604a789adf2e00e9e41a/fcda8/33_iot_rollouts_target_filters.png 590w,
/static/a02f9c63f2c4604a789adf2e00e9e41a/efc66/33_iot_rollouts_target_filters.png 885w,
/static/a02f9c63f2c4604a789adf2e00e9e41a/c83ae/33_iot_rollouts_target_filters.png 1180w,
/static/a02f9c63f2c4604a789adf2e00e9e41a/928ed/33_iot_rollouts_target_filters.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The empty target filters overview&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/2ce1709198950b323fcea0cac6855299/928ed/34_iot_rollouts_new_target_filter.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABZ0lEQVQoz4WR6U7CQBSF+/4PYlQ0AWJCMAhGiAFRQBAkLIIFyla6L9Np4XhLI1FA+fFl7mRmzpxzr5Cp9PDaEZGt9tGbaBjODQxmxFTf1uLCOomkOJA/RlBnKwipUhvpYhO35Q6KTRFP7yOU22OUaW0OFuhOFHTHp+nTvY64hJDI15EsvOHmsYXWcI6V4WAq6zBsBuYHcDx/h8uDo4Rn/hrkVoOQLDSQKraQINHaxycUwyJBDbrlwnQYdDtaQwzCdj1YRLi3Gd/VmuVQGnJ4fV9D/KGOeL5BESV4nINxH55PrpgHRTdpz+F6HLKqQ6UPLRKQNZ0+tSmJA5PglGa0UCHEshVc5QgS7ksK1hscxGN78Y7VPj2UVmbkMCSWq9J0VfBgDftH3w4JfvX0u2bUxLlqQTjPPOPi7oVcVjFeGiS4+XcAfw3Fo8gr040Ez9IlXFL0qWJuL1jUbJv5RwiHELF/FjrXbY4viVmjZl13H+0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;34 iot rollouts new target filter&quot;
        title=&quot;34 iot rollouts new target filter&quot;
        src=&quot;/static/2ce1709198950b323fcea0cac6855299/fcda8/34_iot_rollouts_new_target_filter.png&quot;
        srcset=&quot;/static/2ce1709198950b323fcea0cac6855299/12f09/34_iot_rollouts_new_target_filter.png 148w,
/static/2ce1709198950b323fcea0cac6855299/e4a3f/34_iot_rollouts_new_target_filter.png 295w,
/static/2ce1709198950b323fcea0cac6855299/fcda8/34_iot_rollouts_new_target_filter.png 590w,
/static/2ce1709198950b323fcea0cac6855299/efc66/34_iot_rollouts_new_target_filter.png 885w,
/static/2ce1709198950b323fcea0cac6855299/c83ae/34_iot_rollouts_new_target_filter.png 1180w,
/static/2ce1709198950b323fcea0cac6855299/928ed/34_iot_rollouts_new_target_filter.png 2552w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;Creating a new target filter&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;If you followed this steps, you should now have succesfully setuped everything you need in the Bosch IoT Suite to now connect our device.&lt;/p&gt;
&lt;p&gt;You can go ahead with &lt;a href=&quot;/2020-08-26-esp32_ci_cd_part4&quot;&gt;Part 4 - Uploading and distributing the firmware using Bosch IoT Rollouts&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Building ESP32 firmware using Platfom.IO and GitHub Actions]]></title><description><![CDATA[This is the second part of a multi-part blog post. You might want to start from the beginning with the first post. Let’s start by setting up…]]></description><link>https://cgrotz.github.io/2020-08-24-esp32_ci_cd_part2/</link><guid isPermaLink="false">https://cgrotz.github.io/2020-08-24-esp32_ci_cd_part2/</guid><pubDate>Mon, 24 Aug 2020 08:13:00 GMT</pubDate><content:encoded>&lt;p&gt;This is the second part of a multi-part blog post. You might want to start from the beginning with the &lt;a href=&quot;/2020-08-23-esp32_ci_cd_part1&quot;&gt;first post&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Let’s start by setting up a Platform.IO project for GitHub Actions, just create a new project in Platform.IO. Select the board you are developing against, in my case I selected the M5 Stack option.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/2b90e2c536bf741d783429e4acbb80aa/e72de/create_new_project.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 78.37837837837837%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB4klEQVQ4y5VUSXLbMBDkN1KVVMoSwQXgJnGVRFP0ybnlmGvyhdzyhlzzmbyuMz0s0LIdeTk0BxgAPY2ZAYMkSTEMB7RtpzbLcmy3IYyJ/oswNFf8EeI4QcBP0zTY72uxLax16yFaj0uyS/9lACU0xiCKYnXQ0kmkqX0E3oTWrzEw4X1cJ0eQJAlOp5Ned5omHA5HHI8n8Y04n2fxnXF7O+mc+2jneda1eb5T0MeUUW3AD5Uxd85laquqQlGUCufcCmutrGc6XlTa9QzHVKmELEJdNyjLSnK5R9f1onhA3/dKwAN5vuBy7Ofck+eFkgdPE84oRBQtuWSeOPe5fQ2BrxRVsdK73U7yeEAtY8578VOJ0dRI4cxz+IKyHuuVN5vt0kuJRRSLokSUpU7tm6B7LQKSNVKhcRxR7RvsOqn0OMOVNWJbIHElYsK+jMRVSItWGluk+j5cmlPUpRlMbFdEhKh4GZki8Mls6hplPSAf7pE5u7ZOKbDSImEYvglKSIVFIWXP5HA5CEGqLbC8hkwDMr+heYyHtyw3lK4ggmXzUphQsXn2Vq//EIwGMnLm5tMHbD5/5Fv2ZfeR4qt/mqdk2p9mi7T7gun7b7Rffz704XtAQt5ICcMbuOkb7n/9xfHHH/wDP93ebk/FhnYAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;create new project&quot;
        title=&quot;create new project&quot;
        src=&quot;/static/2b90e2c536bf741d783429e4acbb80aa/fcda8/create_new_project.png&quot;
        srcset=&quot;/static/2b90e2c536bf741d783429e4acbb80aa/12f09/create_new_project.png 148w,
/static/2b90e2c536bf741d783429e4acbb80aa/e4a3f/create_new_project.png 295w,
/static/2b90e2c536bf741d783429e4acbb80aa/fcda8/create_new_project.png 590w,
/static/2b90e2c536bf741d783429e4acbb80aa/efc66/create_new_project.png 885w,
/static/2b90e2c536bf741d783429e4acbb80aa/c83ae/create_new_project.png 1180w,
/static/2b90e2c536bf741d783429e4acbb80aa/e72de/create_new_project.png 1198w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;Platform.IOs create new project dialog&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;After the creation your project structure should look similar to what you can see on the following screenshot.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 454px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4cedd15ad81057a1893c111a3f53348f/b3c1d/project_layout_after_creation.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 105.40540540540542%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAABYlAAAWJQFJUiTwAAACZklEQVQ4y52USXPaQBCFfc8vSIolCKFlpJEQiyT2TewIMK7YuMwpleWaVOWcS2455C+/9AzBhV0EZB8aCUq8+fT6dV+ZJgO3LXzaDjBoh+j1IlQqVXQ6Xbrvo1r1MRhEj99tmyOfV1EoaCfrymQWCTL8/HYDPyhjEI3g+74UmM3maDZbUmi5XGE8nsCy7POChUIBJuPghokv0zo0TZN/FCTpdAaqWkA2+15WJpN9FBO/nxTUNB2GaaFWtPBjUYbnuhiN9iRCUAiIZ8TDh+v/xPaE9BC3LJjlBjKr72C8iO4/v9bra5RKZShK/qLQE0JGr2s4FaSGH2HYLtqtFsJaHe12B65bPOvZSUHbdlD2PGyvY9TrDUTREP1+H9PpDIya9mJBwzBgcwfTeQzPK1GXA7SIstvtvUZQk4TNoISvmwF67S6GozFSqbTs7KWuniTUdQNFx8W8E8ElUo8aIQSSdPVElzV4joecp+NN/A5BLcRkMoWYoJcIPSE0dRMK0/A2zIBzLjv7nCz5K9OHVfQQqRp+08SIUftwe4taWEMup7xCkAhVqgpjiAMfOmVSLAeDriLQQugglijYuq4jraiYeBy/hjVY1JT77T3u7rZYrdbYbG7ktBzTXiTM08kuM9D3HVi0FIIglGtLeOlQ90UWk1JKQoUIK0T4sO7BJT/FDC8WMebzBeI4lnOd1M+9h3TDSDiwTMqkKanExIgq0gEiQsLTRIQGhTqdU7FoePjzeYp6q4vdbic9FITCwzheyuLk72HznFmw4lQNBgWcm2I3Mkl0mKDjSkR4bLaS30dEzO8hLs/rkuhfSCN8X1fHkeQAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;project layout after creation&quot;
        title=&quot;project layout after creation&quot;
        src=&quot;/static/4cedd15ad81057a1893c111a3f53348f/b3c1d/project_layout_after_creation.png&quot;
        srcset=&quot;/static/4cedd15ad81057a1893c111a3f53348f/12f09/project_layout_after_creation.png 148w,
/static/4cedd15ad81057a1893c111a3f53348f/e4a3f/project_layout_after_creation.png 295w,
/static/4cedd15ad81057a1893c111a3f53348f/b3c1d/project_layout_after_creation.png 454w&quot;
        sizes=&quot;(max-width: 454px) 100vw, 454px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The project layout after creation&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Your platfomio.ini should look similar to this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ini&quot;&gt;&lt;pre class=&quot;language-ini&quot;&gt;&lt;code class=&quot;language-ini&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;[env:m5stack-core-esp32]&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;platform&lt;/span&gt; &lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; espressif32&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;board&lt;/span&gt; &lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; m5stack-core-esp32&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;framework&lt;/span&gt; &lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; arduino&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;Platform.IO configuration file&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The key thing you need to look for, is the name of the environment in the above example &lt;em&gt;m5stack-core-esp32&lt;/em&gt;. The firmware binary will be placed in a folder with this name later on, therefore we will need this information in order to reference the file in the build.&lt;/p&gt;
&lt;p&gt;Create a GitHub Action workflow yml file in the &lt;em&gt;.github/workflows/&lt;/em&gt; folder (you might need to create the folder). &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;push&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ubuntu&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;latest
    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/checkout@v1
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Set up Python
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/setup&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;python@v1
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Install dependencies
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
        python -m pip install --upgrade pip
        pip install platformio&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Run PlatformIO
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; platformio run
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Attach artifact
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/upload&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;artifact@v2
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; firmware_esp32
        &lt;span class=&quot;token key atrule&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .pio/build/m5stack&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;core&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;esp32/firmware.bin&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;.github/workflows/ci.yml&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The result of each job execution will be attached to build pipeline. You can then download the result in the GitHub actions page.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/67c29a787042700853c7a0ad6332352c/d2782/github_actions_result.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 40.54054054054054%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAyUlEQVQoz5VS0Q6DIAzk//9rj/uK7QEUFQR0UPBWjDPbwxJscmlpmuu1RfgIuPCCtQbOe/YzZufgQ8C2bc2gnJEZYn4BcrBQSkFKha7robWGsRZXrJSCzBBpDXCjxrqsmIxBSuksalVXiXIueyxu8o7H8ITuNMZpQliWvVsrWbUYE69oQWQxQo09BjOdsq/s7Yf48CIngvEJ0hJGT3uyVJTDf+Lv95Hbx+VDBF4XxYjCXMLzZftes1ziQvwdq3WnonYgoqYv0UL4BivvdgluFrlGAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;github actions result&quot;
        title=&quot;github actions result&quot;
        src=&quot;/static/67c29a787042700853c7a0ad6332352c/fcda8/github_actions_result.png&quot;
        srcset=&quot;/static/67c29a787042700853c7a0ad6332352c/12f09/github_actions_result.png 148w,
/static/67c29a787042700853c7a0ad6332352c/e4a3f/github_actions_result.png 295w,
/static/67c29a787042700853c7a0ad6332352c/fcda8/github_actions_result.png 590w,
/static/67c29a787042700853c7a0ad6332352c/efc66/github_actions_result.png 885w,
/static/67c29a787042700853c7a0ad6332352c/c83ae/github_actions_result.png 1180w,
/static/67c29a787042700853c7a0ad6332352c/d2782/github_actions_result.png 1864w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The resulting artifact in the GitHub Actions job run&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;You can find the complete example with build here: &lt;a href=&quot;https://github.com/cgrotz/esp32-platformio-example&quot;&gt;Link&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In the next post I am going to guide you through preparing everything in the Bosch IoT Suite for distributing the firmware updates. &lt;a href=&quot;/2020-08-25-esp32_ci_cd_part3&quot;&gt;Part 3 - Preparing the Bosch IoT Suite&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Getting started with CI/CD for ESP32 using GitHub Actions, Platform.IO and Bosch IoT Suite]]></title><description><![CDATA[Continuous Integration and Delivery is a practice that is normally associated with development of web applications and mobile applications…]]></description><link>https://cgrotz.github.io/2020-08-23-esp32_ci_cd_part1/</link><guid isPermaLink="false">https://cgrotz.github.io/2020-08-23-esp32_ci_cd_part1/</guid><pubDate>Sun, 23 Aug 2020 08:13:00 GMT</pubDate><content:encoded>&lt;p&gt;Continuous Integration and Delivery is a practice that is normally associated with development of web applications and mobile applications. When discussing embedded development this is not normally done. There is of course the risk of bricking a device due to the lack of sandboxing on constrained hardware, or that you have specific hardware needs. Even a working recovery flow, is seldomly available.
Of course new apporaches like MicroPython provide novel capabilities, but the risk of rendering a device permanently disconnected or completely useless is still there.&lt;/p&gt;
&lt;p&gt;In this blog post, we are going to ignore all of this, I want to show you the technical steps that you need to do today to use CI/CD for updating ESP32 based devices.&lt;/p&gt;
&lt;p&gt;I am going to split this blog post into multiple parts. First I am going to give you an overview of what we want to achieve, and then we are going to work step by step on building the solution.&lt;/p&gt;
&lt;h2&gt;The High-Level View&lt;/h2&gt;
&lt;p&gt;I am going to use platfom.io for building our firmware. It’s an open-source “professional collaborative platform for embedded development”. It already has a good tooling ecosystem in place, and solves many needs like testing and dependency management in a contemporary fashion.&lt;/p&gt;
&lt;p&gt;I will use GitHub Actions to continuously integrate the firmware.&lt;/p&gt;
&lt;p&gt;Last, but not least, I will use the Bosch IoT Suite’s Device Management Package to deliver the firmware to the devices.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/f58918e5e9d2af60109b3a3b9f70d377/8bd7c/BlogpostDiagram.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 48.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACs0lEQVQoz2Pg5+bVEeITtBTk5VcV4hUw5ufhkwKypThYWEV7Zi1hZwCCJ89fuF988/P/1ttvfj1/9/nv92/f/n77/v3v5y9fwfjDp89/f/z4ARZjEOYXjBcVEO4A4jlAPBWIp4kLifaxMzInHb/1SuHo7U8Vl27dT9j45M//ade//N9y4fH/1XvO/99+/Mb/A+fu/t94+Or/87ee/X/+9vP/B8/f/2cAulBehF/ISphPUJeDiUUJSJsD+bZAcY2eCRPBLnz24qXTqcfvv+x98PHhq0/fnnz58u3xx8/fHn/7/uPZl2/fn/78+fP59x8/n//48fMZAzLIr2wUZMACJuREMb6bVcx+bfdWwbkzZkidPHtBeP/hE6J93R2cl49uZ/dwcxGKDgvkbG+sYmf4/+0dXOOag5dVYOya8npGEL3jwCm4/OG7X00O3PzoeezOJ9ezT347bz33nGPO1vPSc7ddEEdxwcI1h1U37btitXD3Pev1ey5ZLV53VBckvnPPYYj80lUMy1YsZcis7GSEauFiYFAUgLIZNYxtmGvKihhOnoJafuXmk13/geDD1d3////7/f/63Rd3QOJAIYbZK4+B1cir6oL5IBAWHjVh375tz9Zt3tIckjVRm1NAgktBjJMR7sKHT9+CDfx7fcO3//++/n/59vM1mFxKw3YwnZOXCaZ1zO24q2uqD+7Zvur/pDnr/le1zPo/dc6iDJDclk3bmRhmLt2rt3bb8d+7j974v+XA9f87D1/7v3Xf+f+zl+/3BClatuEQU3rDZgYWqAXcXFzMU6IYWJKSY+wKy+tXVtS3X5g8Ywo47O88esjIMHvFgag1mw9Nm7hw7+TWWbtm9S/YO2XVpkNT5686kAPx9nsGkIHSSppwL8/dfslkz81vfrsuPAxcc/hqrJZ3HgcsiADm1mcLvSBVJQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;BlogpostDiagram&quot;
        title=&quot;BlogpostDiagram&quot;
        src=&quot;/static/f58918e5e9d2af60109b3a3b9f70d377/fcda8/BlogpostDiagram.png&quot;
        srcset=&quot;/static/f58918e5e9d2af60109b3a3b9f70d377/12f09/BlogpostDiagram.png 148w,
/static/f58918e5e9d2af60109b3a3b9f70d377/e4a3f/BlogpostDiagram.png 295w,
/static/f58918e5e9d2af60109b3a3b9f70d377/fcda8/BlogpostDiagram.png 590w,
/static/f58918e5e9d2af60109b3a3b9f70d377/8bd7c/BlogpostDiagram.png 845w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;The components used for this experiment&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;When doing CI/CD it’s always a good idea to spend some time on the Git workflow you are going to use. In contemporary software development direct commits to a main branch without code reviews, builds and tests are of course outdated. Feature development is normally solved on feature branches that are later reviewed by other developers using pull requests. Bugfixes are similarly solved on bugfix branches. Releases are only done from the main branch. Here is of course a decision possible, whether or not to have release branches or simply tag releases.&lt;/p&gt;
&lt;p&gt;We use two different build jobs, one for building pull requests and another for continuously building releases from the main branch. They differ in regards to more extensive testing and the release publishing on the main branch.&lt;/p&gt;
&lt;p&gt;When all test are passed as green, the firmware is automatically deployed to our Beta Fleet (which for the purpose of this blog consists of a single M5 Stack ESP32). When using this approach in a more production setting, the Beta Fleet could be devices that were passed to a friendly set of users, where also additional telemetry is collected.&lt;/p&gt;
&lt;p&gt;You can find the complete example here: &lt;a href=&quot;https://github.com/cgrotz/esp32-platformio-example&quot;&gt;Link&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In the next post, I am going to show you what you need to configure in Platform.IO and GitHub to build your ESP32 firmware. &lt;a href=&quot;/2020-08-24-esp32_ci_cd_part2&quot;&gt;Part 2 - Building ESP32 firmware using Platfom.IO and GitHub Actions&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Using RTOS tasks on ESP32 under Arduino]]></title><description><![CDATA[Today I got my first set of ESP 32 boards from AliExpress, and they are a beauty. If you don’t know the ESP32 yet, it’s the successor of the…]]></description><link>https://cgrotz.github.io/2018-01-14-using-rtos-tasks-on-esp32-under-arduino/</link><guid isPermaLink="false">https://cgrotz.github.io/2018-01-14-using-rtos-tasks-on-esp32-under-arduino/</guid><pubDate>Sun, 14 Jan 2018 08:13:00 GMT</pubDate><content:encoded>&lt;p&gt;Today I got my first set of ESP 32 boards from AliExpress, and they are a beauty. If you don’t know the ESP32 yet, it’s the successor of the ESP8266 from Espressif Systems which is a love child of the IoT prototyping community.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/344b1abea81730892435eb5fef26f916/6533e/esp32.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABAAB/8QAFgEBAQEAAAAAAAAAAAAAAAAAAwEC/9oADAMBAAIQAxAAAAFQ1mJD22b/AP/EABsQAAIBBQAAAAAAAAAAAAAAAAEREgACAxAx/9oACAEBAAEFAhwt1JC/JLX/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAADAAAAAAAAAAAAAAAAAAAQESD/2gAIAQEABj8ChD//xAAaEAACAgMAAAAAAAAAAAAAAAAAARExECHB/9oACAEBAAE/IUipebfBzJrD6Mf/2gAMAwEAAgADAAAAEDAf/8QAFhEAAwAAAAAAAAAAAAAAAAAAEBEh/9oACAEDAQE/EKx//8QAFxEAAwEAAAAAAAAAAAAAAAAAARARIf/aAAgBAgEBPxDIV//EABoQAQEBAQEBAQAAAAAAAAAAAAERACExkdH/2gAIAQEAAT8Q6jhCkSAevudOZg+xqJcWIANL1/Mvd//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;esp32&quot;
        title=&quot;esp32&quot;
        src=&quot;/static/344b1abea81730892435eb5fef26f916/1c72d/esp32.jpg&quot;
        srcset=&quot;/static/344b1abea81730892435eb5fef26f916/a80bd/esp32.jpg 148w,
/static/344b1abea81730892435eb5fef26f916/1c91a/esp32.jpg 295w,
/static/344b1abea81730892435eb5fef26f916/1c72d/esp32.jpg 590w,
/static/344b1abea81730892435eb5fef26f916/a8a14/esp32.jpg 885w,
/static/344b1abea81730892435eb5fef26f916/6533e/esp32.jpg 1160w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;My new ESP32 board from Widora with his older brother the ESP8266 based NodeMCU in the background&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;My new ESP32 board from Widora with his older brother the ESP8266 based NodeMCU in the background
The specs are amazing, it seems Espressif took everything the community love about the ESP8266 and fixed many of disadvantages. The following table (content from wikipedia.org, compares them quite nicely)&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Item&lt;/th&gt;
&lt;th&gt;ESP8266&lt;/th&gt;
&lt;th&gt;ESP32&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;CPU&lt;/td&gt;
&lt;td&gt;32 Bit, 80Mhz, Single Core&lt;/td&gt;
&lt;td&gt;32 Bit, 160 or 240 MhZ, Dual Core&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Wifi&lt;/td&gt;
&lt;td&gt;802.11 b/g/n&lt;/td&gt;
&lt;td&gt;802.11 b/g/n&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Bluetooth&lt;/td&gt;
&lt;td&gt;–&lt;/td&gt;
&lt;td&gt;4.2 + BLE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ADC&lt;/td&gt;
&lt;td&gt;10 Bit&lt;/td&gt;
&lt;td&gt; 12 Bit&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Peripherie&lt;/td&gt;
&lt;td&gt;16 GPIO pins, SPI, I²C (software implementation), I²S interfaces with DMA (sharing pins with GPIO), UART on dedicated pins, plus a transmit-only UART can be enabled on GPIO2&lt;/td&gt;
&lt;td&gt;12-bit SAR ADC up to 18 channels, 2 × 8-bit DACs, 10 × touch sensors (capacitive sensing GPIOs), Temperature sensor, 4 × SPI, 2 × I²S interfaces, 2 × I²C interfaces, 3 × UART, SD/SDIO/CE-ATA/MMC/eMMC host controller, SDIO/SPI slave controller, Ethernet MAC interface with dedicated DMA and IEEE 1588 Precision Time Protocol support, CAN bus 2.0, Infrared remote controller (TX/RX, up to 8 channels), Motor PWM, LED PWM (up to 16 channels), Hall effect sensor, Ultra low power analog pre-amplifier&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Other&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Ultra low power (ULP) co-processor, Wakeup from Interrupt, Cryptographic hardware acceleration: AES, SHA-2, RSA, elliptic curve cryptography (ECC), random number generator (RNG)…&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The Espressif IoT Development Framework (Link) includes FreeRTOS, and you can conveniently use it from the Arduino ID. Simply create and delete FreeRTOS tasks using the well known commands.&lt;/p&gt;
&lt;p&gt;{% highlight c %}
void setup() {
Serial.begin(115200);
xTaskCreate(readSensor, “ReadSensorTask”, 10000, NULL, 1, NULL);
}&lt;/p&gt;
&lt;p&gt;void loop() {
delay(2000);
}&lt;/p&gt;
&lt;p&gt;void readSensor( void * parameter ) {
int i = 0;
while(true){
char buffer [50];
sprintf (buffer, “Hello From Task %d”, i++ );
Serial.write(buffer);
delay(1000);
}
}
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;The first parameter of the &lt;a href=&quot;https://www.freertos.org/a00125.html&quot;&gt;xTaskCreate&lt;/a&gt; function takes the pointer to the function that implements this task. The second parameter is the task name, the name can be used for debugging, but could also be used for retrieving a task handle. The third parameter is the stack size that should be allocated for this task, determining the stack size can be a challenging task &lt;a href=&quot;https://www.freertos.org/FAQMem.html#StackSize.&quot;&gt;Link&lt;/a&gt;. The fourth parameter is a value that is passed to the task as a parameter. The fifth task is the priority of the task. The sixth parameter can be passed in to obtain a handle on the task directly.&lt;/p&gt;
&lt;p&gt;With this simple setup, you can have a separate task running in the background reading for example the ADC and posting the result to a BLE characteristic. Isn’t that cool?&lt;/p&gt;</content:encoded></item><item><title><![CDATA[How to run a trained Tensorflow model on Cloud Foundry]]></title><description><![CDATA[AI models are becoming more and more commodity nowadays. This entry is focusing on, how you can train a Tensorflow model offline and push it…]]></description><link>https://cgrotz.github.io/2017-04-09-how-to-run-a-trained-tensorflow-model-on-cloud-foundry/</link><guid isPermaLink="false">https://cgrotz.github.io/2017-04-09-how-to-run-a-trained-tensorflow-model-on-cloud-foundry/</guid><pubDate>Sun, 09 Apr 2017 08:13:00 GMT</pubDate><content:encoded>&lt;p&gt;AI models are becoming more and more commodity nowadays. This entry is focusing on, how you can train a Tensorflow model offline and push it to Cloud Foundry to provide your model as an API. Our starting point is the very good beginner sample for MNIST image recognition from Tensorflow itself &lt;a href=&quot;https://www.tensorflow.org/get_started/mnist/beginners&quot;&gt;MNIST Getting Started&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;You can get the sources of this examples from my Github repository. &lt;a href=&quot;https://github.com/cgrotz/tensorflow-cloudfoundy&quot;&gt;Source on GitHub&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The first thing to do, is to add the following lines at the end of your training code:&lt;/p&gt;
&lt;p&gt;{% highlight python %}
saver = tf.train.Saver()
saver.save(sess, “model/trained.ckpt”)
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;This saves the currently trained model into the folder model as the trained checkpoint. Which allows you to reload the model later.&lt;/p&gt;
&lt;p&gt;The next step is to create a web application that is able to load the model and provide an API to it. For this we are going to use &lt;a href=&quot;http://flask.pocoo.org/&quot;&gt;Flask&lt;/a&gt;. Flask is a microframework for Python, that provides the possibility to quickly and easily provide HTTP APIs. To install flask you can simply use pip (e.g. pip install Flask).&lt;/p&gt;
&lt;p&gt;You can see the whole code in the run.py file. I’m going to highlight the main points here.&lt;/p&gt;
&lt;p&gt;First of all, we need to normally init the variables and model we are going to run.&lt;/p&gt;
&lt;p&gt;{% highlight python %}&lt;/p&gt;
&lt;h1&gt;This is the model&lt;/h1&gt;
&lt;p&gt;x = tf.placeholder(tf.float32, [None, 784])
W = tf.Variable(tf.zeros([784, 10]), name = ‘W’)
b = tf.Variable(tf.zeros([10]), name = ‘b’)
y = tf.nn.softmax(tf.matmul(x, W) + b)
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;Next we are going to load the previously stored value for the variables. This recreates the model we previously trained.&lt;/p&gt;
&lt;p&gt;{% highlight python %}&lt;/p&gt;
&lt;h1&gt;Load the stored model&lt;/h1&gt;
&lt;p&gt;saver = tf.train.Saver()
saver.restore(sess, “model/trained.ckpt”)
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;Afterwards we create our Flask request handler.&lt;/p&gt;
&lt;p&gt;{% highlight python %}&lt;/p&gt;
&lt;h1&gt;A request handler for calling the Tensorflow model&lt;/h1&gt;
&lt;p&gt;@app.route(’/’, methods=[‘POST’])
def process&lt;em&gt;call():
#prepare the model
input = ((255 - np.array(request.get&lt;/em&gt;json(), dtype=np.uint8)) / 255.0).reshape(1, 784)
#execute the model and respond the result as JSON
return jsonify(
sess.run(y, feed_dict={x: input}).flatten().tolist()
)
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;That’s all, if you have installed Tensorflow and Flask you can now simply run python run.py  to start the API locally.&lt;/p&gt;
&lt;p&gt;The next step is to deploy our simple application to Cloud Foundry. I assume you already have either a Cloud Foundry installation up and running or have an account with run.pivotal.io. Also you should have setup your cf-cli tool to point to this installation.&lt;/p&gt;
&lt;p&gt;We are going to add Gunicorn. Gunicornis a Python HTTP Server and provides a pre-fork worker model. The Gunicorn server provides a great basis for Python web applications with it’s worker model and is widely used. And a great match for running Python on Cloud Foundry.&lt;/p&gt;
&lt;p&gt;Our application is now like every other Python app, we want to run on Cloud Foundry. There are 3 key files, that we need to know about, in order for the Cloud Foundry buildpack to identify our app as a Python app and package it correctly.&lt;/p&gt;
&lt;p&gt;requirements.txt – This file contains the libraries that PIP should install. PIP is run by the Python buildpack while creating the droplet. The content should look like the following lines:&lt;/p&gt;
&lt;p&gt;{% highlight python %}
tensorflow==1.0.1
Flask==0.12.1
gunicorn==19.7.1
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;runtime.txt – This file contains which Python version to use. Our example needs python 3.4 to run. The content should look like the following lines:&lt;/p&gt;
&lt;p&gt;{% highlight python %}
python-3.6.0
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;Procfile – This file gives the command line with which the buildpack should start the application&lt;/p&gt;
&lt;p&gt;{% highlight python %}
web: gunicorn run:app —log-file=-
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;When you have configured those files, you can simple push your app using cf-cli from the folder:&lt;/p&gt;
&lt;p&gt;{% highlight sh %}
cf push &amp;#x3C;app_name&gt;
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;Now let’s make a test request to our  AI API. For example the following json array is the letter 3 or at least my painting of the letter 3 using paint and a touchpad.&lt;/p&gt;
&lt;p&gt;{% highlight json %}
[ 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0,
0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0,
0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0,
0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0,
0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0,
1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0,
1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0,
0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0,
0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ]
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;You can simply POST it against your newly created Cloud Foundry app,  just set the Content-Type header to application/json so that the content is automatically read. The response should look like the following&lt;/p&gt;
&lt;p&gt;{% highlight json %}
[
0.0000050957642088178545,
1.7136410376778844e-15,
0.14846764504909515,
0.813301682472229,
3.0202426930941995e-12,
0.03664221242070198,
2.5848851237242343e-7,
6.163446641949122e-8,
0.0015830846969038248,
5.507514888591913e-9
]
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;In this example the 3 was actually correctly detected, hurray. Of course you can make the API fancier and maybe add some authentication and authorisation to it. Maybe you also want to add a billing option to earn some money with your awesome model.&lt;/p&gt;
&lt;p&gt;Ideally you automate the training of the model using for example Jenkins to automatically re-train and re-deploy the model if the newer version has a higher accuracy.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Getting Started with Ethereum]]></title><description><![CDATA[So, you want to get started with Ethereum? I found that when experimenting with blockchain as a developer it’s best, to setup your own…]]></description><link>https://cgrotz.github.io/2017-02-15-getting-started-with-ethereum/</link><guid isPermaLink="false">https://cgrotz.github.io/2017-02-15-getting-started-with-ethereum/</guid><pubDate>Wed, 15 Feb 2017 08:13:00 GMT</pubDate><content:encoded>&lt;p&gt;So, you want to get started with &lt;a href=&quot;https://www.ethereum.org/&quot;&gt;Ethereum&lt;/a&gt;? I found that when experimenting with blockchain as a developer it’s best, to setup your own private mini blockchain. I will do this steps on MacOS, depending on your operating system, some of the steps could be different for you.&lt;/p&gt;
&lt;p&gt;The first step is in installing the Geth command line tool on your computer. Geth is a tool, that allows you to manage your local Geth installation and run your own Ethereum node.&lt;/p&gt;
&lt;p&gt;For Mac users it’s a good to choose the Homebrew installation. It’s brings along everything you need. For other systems, you can find the very simple instructions here &lt;a href=&quot;https://www.ethereum.org/cli&quot;&gt;ethereum-cli&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;{% highlight sh %}
brew update
brew upgrade
brew tap ethereum/ethereum
brew install ethereum
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;After that, you should install the Ethereum Wallet to interact with the Ethereum network. You can simply download the Ethereum Wallet from the Github Releases page. &lt;a href=&quot;https://github.com/ethereum/mist/releases&quot;&gt;ethereum-mist&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The Wallet will run a Geth node in the Background, and interact with this node via a socket based RPC mechanis. After you installed and started the Wallet it will ask you to create your Key Pair. This is your identity on the blockchain. The Wallet will automatically try to connect with the public Ethereum network. Note down your Blockchain address, we will need this in the follow steps. We will quit the Wallet for now, because we want to run our own network and don’t want to run on the public Ethereum network.&lt;/p&gt;
&lt;p&gt;For that, you have to go to the command line. And create a folder called datadir. This folder will be used by our Geth node for storing all the data. Next thing we have to do, is to create a genesis.json file. This file contains the information for the Genesis Block. Which means the first Block of our Blockchain. Because we don’t want to start poor in our Blockchain tests, we maybe want to mint some money. The content of the genesis.file should look like this:&lt;/p&gt;
&lt;p&gt;{% highlight json %}
{
“config”: {
“homesteadBlock”: 10
},
“nonce”: “0”,
“difficulty”: “0x20000”,
“mixhash”: “0x00000000000000000000000000000000000000647572616c65787365646c6578”,
“coinbase”: “0x0000000000000000000000000000000000000000”,
“timestamp”: “0x00”,
“parentHash”: “0x0000000000000000000000000000000000000000000000000000000000000000”,
“extraData”: “0x”,
“gasLimit”: “0x2FEFD8”,
“alloc”: {
“address of your wallet with leading 0x”: {
“balance”: “20000000000000000000”
}
}
}
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;The next step is to use this genesis file to init the genesis block on your node. To do this, execute the following command on the console:&lt;/p&gt;
&lt;p&gt;{% highlight sh %}
geth —datadir ”&lt;location of your datadir&gt;” init &lt;path to genesis file&gt;
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;Now you can start your private Geth node with the following command (please replace the location of your data dir and the ethereum folder):&lt;/p&gt;
&lt;p&gt;{% highlight sh %}
geth —datadir ”&lt;location of your datadir&gt;” \
—networkid 9 \
—port “30303” —nodiscover —autodag \
—rpc —rpcport “8545” —rpccorsdomain ”*“—rpcaddr “0.0.0.0” \
—ipcpath &lt;path to ethereum folder&gt;/geth.ipc \
console&amp;#x3C;
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;Let’s dissect this command.
–datadir provides the location of the data dir, that holds the local Blockhain copy
–networkid identifies the network we want to connect to, has to be the same on all the nodes. should be greater than 3 due to public Ethereum networks using 1 and 3
–port defines the port through which this node can communicate with other Geth nodes
–nodiscover we don’t want our node to be automatically detected by other nodes
–autodag enable automatic DAG pregeneration
–rpc and following defines the JSON-RPC accessibility of our node
–ipcpath defines the path for the IPC file, this is important, so we can use the Ethereum Wallet as a UI
console start the node with a foreground console so we can easily interact with&lt;/p&gt;
&lt;p&gt;Location of the Ethereum IPC folder on other platforms:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;OS&lt;/th&gt;
&lt;th&gt;Location&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OS X&lt;/td&gt;
&lt;td&gt;~/Library/Ethereum/&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Linux&lt;/td&gt;
&lt;td&gt;~/.ethereum/&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Windows&lt;/td&gt;
&lt;td&gt;~/AppData/Roaming/Ethereum&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Okay, so we now have started our very first Ethereum node, and you should see a command prompt.&lt;/p&gt;
&lt;p&gt;To check if your node is working correctly, you can for example use&lt;/p&gt;
&lt;p&gt;{% highlight c %}
eth.accounts
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;to get an array of all the addresses installed with your Geth node.&lt;/p&gt;
&lt;p&gt;{% highlight c %}
[“0xd4bf167a7f595d3c4d1502dd82408eabe96b7ff3”,
“0x68d40b98b247cdda1ac6c44870fce3dce91571ae”,
“0xb190456d0078f47c5cb9ea3701de9c6a9cdb3e44”]
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;If you want to check the balance of a address you can simply use:&lt;/p&gt;
&lt;p&gt;{% highlight c %}
web3.fromWei(eth.getBalance(”&lt;address&gt;”), “ether”);
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;Now let’s start the Ethereum Wallet again. After login you should see something like this:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/d23f080752d2be0530b6796be64319a9/2bef9/Wallet-1024x686.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 66.89189189189189%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACMklEQVQ4y52Sa47TMBDHcwvERyQuQoV2JbhE4QsnKdyHI6yEturHljZt01ahS5Im3bxs52F76mHsFd2teEhg6Sd7xqP/eGbszefzZ/v9/l0cx5ahJYmi4SG/Hx4NDA9VOYzJjpPEcUhih4sj23KIo2EURe9933/uzWaz133foyQE56hkj5nokR8yzG9uUey/Y68Udm2LquvwyFpM64biJLbkq6oacwIAkB73xlsulwMhhCGgriogUch5A1WUwPHmFurwDpqudf7W3jEBeS2gaRrgnEFdMyiY0B0lW61W195msxlorZExZsqicAg6c0oiEY02xiilzmitDOintiZbm9PphLvd7toLgmBAF3jMMrMPQ8MZQ63BlaSoDW6n+79gpJROcLvdPgpmaWq+kWBRFK43XHCkstz5TNNi89QmqFT30rOgLdkKUqDhnJuqLLEocizzAjmzogIbIVDYvW/duaVEwvoISnopuFqvBwAa74+lyQpmwrJB1gGmVYq77A4TprGSCmXVYr3LMeY0aSGpLY8lXwiu14ET9GNmkpwZwRl9kR5zVuChTOkrUdl9hx19Fx4XyKgVgl7Y/ankVbAZICj88EWYz2Fnylaaqu3NSQNNDyhYuqYrO9mTfpiufPD95PKFQfBK9p2ZHqXOhNInUpFKAQX+Si9/59cWWz4JXtmhXCEt3TDM4gjTJMGKJv0/iwTfeuPx+EUYhh+/LvzRdDobzabTkb9YjMj3r3yaTCYvfwB1kLXEGP1aowAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Wallet 1024x686&quot;
        title=&quot;Wallet 1024x686&quot;
        src=&quot;/static/d23f080752d2be0530b6796be64319a9/fcda8/Wallet-1024x686.png&quot;
        srcset=&quot;/static/d23f080752d2be0530b6796be64319a9/12f09/Wallet-1024x686.png 148w,
/static/d23f080752d2be0530b6796be64319a9/e4a3f/Wallet-1024x686.png 295w,
/static/d23f080752d2be0530b6796be64319a9/fcda8/Wallet-1024x686.png 590w,
/static/d23f080752d2be0530b6796be64319a9/efc66/Wallet-1024x686.png 885w,
/static/d23f080752d2be0530b6796be64319a9/2bef9/Wallet-1024x686.png 1024w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;Your Ethereum wallet wih the current balance&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;You can create new accounts with the Add Account button. Do this now to create a second account under your Key Pair. Copy the address of your new account and press the send button at the top.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/c77c0c50659c3b750a3a2cfda876ac62/2bef9/Wallet-Send-1024x694.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 67.56756756756756%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACOUlEQVQ4y6WS34rUMBSHBwV9Ky/1GXyAHRDEN/Fi78QHUGEdHC/ci51hbha9WVZZr1ZhkZ2ZNjNNmuZP06ZtmuNJOoqzKIIGPk7ya/ma02REri4errLlI57zA8bYmFI6ZpyPC+jH3LXjkLE8j+Sh4jrPhyzH9xilB7h+TAi5Nwrj+uqLbNoa1kwAlxqM1qByDvz9GfDzz1AaA1opMIiQCr5lArQuYyaKApJ0A2F8vbycRCFJSaKEgDXZtllGnSi4K7BuP5y57PzCcc5dzpgrKHWUMpdsmcOdxoxlmSNb2tjaBuHLKCzLkrRtAzmjvdbKV1XlO+e8A4h0XRfXMXOd78N8l7kh68IOkyR5FYVCCBKCpmn7pmngJ9ZCG/g1+w3WNlG4Wq0GoVKKoAykklFYo8QioVbYShXmdQW2ruNHmuYG1u4LsU2idQ3XCelTWcK60LDiGjZCQ4pzIkpQpgJaSKBCAtdmRzmgyihcr9eDUEpJvPdQV3XftC20fwJ/VahDqyHroBuy/R1KqUj4r0qK3to6tldXBtnVsMZ2NV6nkP2Q4mHGq4P5TaEkeFpAGeszSr2SEk/aeGNKX0WMR6FHQawo9CjE58ajLOT7wkKItcdr40rZmXzrNmnisCWk2acdMjywSJi3Q9YE4XK5fBGF1pSywuCjAvhUAlj4t5Gm6TQKTxezZ0+PZm/vHx6/fnB4PHn+5mRyuphPTmbzyXz+d2az2dFisXg3nU6fjHbjNnL3P7mD3MKNjr4DgYaVSA+WNPcAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Wallet Send 1024x694&quot;
        title=&quot;Wallet Send 1024x694&quot;
        src=&quot;/static/c77c0c50659c3b750a3a2cfda876ac62/fcda8/Wallet-Send-1024x694.png&quot;
        srcset=&quot;/static/c77c0c50659c3b750a3a2cfda876ac62/12f09/Wallet-Send-1024x694.png 148w,
/static/c77c0c50659c3b750a3a2cfda876ac62/e4a3f/Wallet-Send-1024x694.png 295w,
/static/c77c0c50659c3b750a3a2cfda876ac62/fcda8/Wallet-Send-1024x694.png 590w,
/static/c77c0c50659c3b750a3a2cfda876ac62/efc66/Wallet-Send-1024x694.png 885w,
/static/c77c0c50659c3b750a3a2cfda876ac62/2bef9/Wallet-Send-1024x694.png 1024w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;em&gt;Your wallet when sending ether&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Set the To field to the address of your newly created account. And for example set the amount to 10 Ether. And confirm the transaction. But what’s that? The Ether is not showing up in your new account. What happened?&lt;/p&gt;
&lt;p&gt;Well, there is no miner running on our network yet, that generates new blocks. We set a pretty low difficulty for generating new blocks, which allows any node to generate new blocks without too much hassle.&lt;/p&gt;
&lt;p&gt;We can start mining of new blocks on our local node by simply executing the following command in the console window:&lt;/p&gt;
&lt;p&gt;{% highlight c %}
web3.miner.start()
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;Because we don’t want to generate millions of blocks without transactions, we should stop mining of new blocks afterwards.&lt;/p&gt;
&lt;p&gt;{% highlight c %}
web3.miner.stop()
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;That’s it. We created our private blockchain. If you want to add nodes to your network, you can follow the steps from above. Create a second folder datadir2 and copy the genesis file to it. You will also need the enode url from your originally created first Geth node. Go back to the console window of your Geth node and execute the following command:&lt;/p&gt;
&lt;p&gt;{% highlight c %}
admin.nodeInfo.enode
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;This will output the enode url, that contains the following information:&lt;/p&gt;
&lt;p&gt;{% highlight c %}
enode://nodekey@ip:port
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;For a second node, we first have to init the genesis block of our chain, and then we can start our node. Pass this in the commands to start a your second Geth node:&lt;/p&gt;
&lt;p&gt;{% highlight c %}
geth —datadir ”&lt;location of your datadir2&gt;” init &lt;path to genesis file&gt;;
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;That’s it, now you have a multi-node Ethereum cluster.&lt;/p&gt;
&lt;p&gt;Edit: Forgot to put in the geth init step for the chain initalization&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Whenjs On Mozilla Rhino]]></title><description><![CDATA[Recently I stumpled up on when.js, a great way of doing concurrency in Javascript with a very easy syntax. For example, it allows a very…]]></description><link>https://cgrotz.github.io/2013-06-12-whenjs-on-mozilla-rhino/</link><guid isPermaLink="false">https://cgrotz.github.io/2013-06-12-whenjs-on-mozilla-rhino/</guid><pubDate>Wed, 12 Jun 2013 08:13:00 GMT</pubDate><content:encoded>&lt;p&gt;Recently I stumpled up on when.js, a great way of doing concurrency in Javascript with a very easy syntax.&lt;/p&gt;
&lt;p&gt;For example, it allows a very easy API for doing asynchronous operations:&lt;/p&gt;
&lt;p&gt;{% highlight js %}
var when = require(“when.js”);
function operation (message) {
var deferred = when.defer();
setTimeout(function(){
deferred.resolve(message);
},1000);
return deferred.promise;
}&lt;/p&gt;
&lt;p&gt;operation(‘Hello World’).then(
function gotIt(img) {
console.log(img);
}
);
{% endhighlight %}&lt;/p&gt;
&lt;p&gt;So I decied to try when.js on Mozilla Rhino and share my findings with you. It was rather simple getting when.js to run on Rhino. All I had to do, was to implement a alternative for setTimeout. After I implemented the Rhino version I decided to also implement a version with dynjs.&lt;/p&gt;
&lt;p&gt;In comparision I’m impressed by the cleaner API of dynjs and the usage of invokedynamic.&lt;/p&gt;
&lt;p&gt;Further Links: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Mozilla Rhino &lt;a href=&quot;https://developer.mozilla.org/de/docs/Rhino&quot;&gt;https://developer.mozilla.org/de/docs/Rhino&lt;/a&gt; &lt;/li&gt;
&lt;li&gt;dynjs &lt;a href=&quot;http://dynjs.org/&quot;&gt;http://dynjs.org/&lt;/a&gt; &lt;/li&gt;
&lt;li&gt;Example code of the Rhino version &lt;a href=&quot;https://github.com/cgrotz/whenjs-rhino-example&quot;&gt;https://github.com/cgrotz/whenjs-rhino-example&lt;/a&gt; &lt;/li&gt;
&lt;li&gt;Example code of the dynjs version &lt;a href=&quot;https://github.com/cgrotz/whenjs-on-dynjs-example&quot;&gt;https://github.com/cgrotz/whenjs-on-dynjs-example&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Rhino Maven Plugin Release]]></title><description><![CDATA[rhino-maven-plugin is a Maven plugin to compile Javascript to Java class file using Mozilla Rhino. The compiled classes require Mozilla…]]></description><link>https://cgrotz.github.io/2013-06-06-maven-rhino-plugin/</link><guid isPermaLink="false">https://cgrotz.github.io/2013-06-06-maven-rhino-plugin/</guid><pubDate>Thu, 06 Jun 2013 08:13:00 GMT</pubDate><content:encoded>&lt;p&gt;rhino-maven-plugin is a Maven plugin to compile Javascript to Java class file using Mozilla Rhino. The compiled classes require Mozilla Rhino to run. The plugin is licensed under the Mozilla Public License 2.0 due to MPL being the license for Rhino&lt;/p&gt;
&lt;p&gt;Maven Distribution&lt;/p&gt;
&lt;p&gt;{% highlight xml %}
&lt;build&gt;
&lt;plugins&gt;
&lt;plugin&gt;
&lt;groupId&gt;de.skiptag&lt;/groupId&gt;
&lt;artifactId&gt;rhino-maven-plugin&lt;/artifactId&gt;
&lt;version&gt;1.0.1&lt;/version&gt;
&lt;/plugin&gt;
&lt;/plugins&gt;
&lt;/build&gt;
{% endhighlight %}
You can start the compilation be simply calling mvn rhino:compile or by adding the following to the plugin tag:&lt;/p&gt;
&lt;p&gt;{% highlight xml %}
&lt;executions&gt;
&lt;execution&gt;
&lt;phase&gt;compile&lt;/phase&gt;
&lt;goals&gt;
&lt;goal&gt;compile&lt;/goal&gt;
&lt;/goals&gt;
&lt;/execution&gt;
&lt;/executions&gt;
{% endhighlight %}
Mozilla Rhino as dependency&lt;/p&gt;
&lt;p&gt;{% highlight xml %}
&lt;dependency&gt;
&lt;groupId&gt;org.mozilla&lt;/groupId&gt;
&lt;artifactId&gt;rhino&lt;/artifactId&gt;
&lt;version&gt;1.7R4&lt;/version&gt;
&lt;/dependency&gt;
{% endhighlight %}
The artifact is deployed to Maven Central so no repository configuration should be necessary.&lt;/p&gt;</content:encoded></item></channel></rss>